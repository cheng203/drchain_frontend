{"ast":null,"code":"import _extends from 'babel-runtime/helpers/extends';\nimport _classCallCheck from 'babel-runtime/helpers/classCallCheck';\nimport _possibleConstructorReturn from 'babel-runtime/helpers/possibleConstructorReturn';\nimport _inherits from 'babel-runtime/helpers/inherits';\n/* eslint func-names: 1 */\n\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport KeyCode from 'rc-util/es/KeyCode';\nimport childrenToArray from 'rc-util/es/Children/toArray';\nimport classnames from 'classnames';\nimport Animate from 'rc-animate';\nimport classes from 'component-classes';\nimport { Item as MenuItem, ItemGroup as MenuItemGroup } from 'rc-menu';\nimport warning from 'warning';\nimport Option from './Option';\nimport { getPropValue, getValuePropValue, isCombobox, isMultipleOrTags, isMultipleOrTagsOrCombobox, isSingleMode, toArray, getMapKey, findIndexInValueBySingleValue, getLabelFromPropsValue, UNSELECTABLE_ATTRIBUTE, UNSELECTABLE_STYLE, preventDefaultEvent, findFirstMenuItem, includesSeparators, splitBySeparators, defaultFilterFn, validateOptionValue, saveRef } from './util';\nimport SelectTrigger from './SelectTrigger';\nimport { SelectPropTypes } from './PropTypes';\n\nfunction noop() {}\n\nfunction chaining() {\n  for (var _len = arguments.length, fns = Array(_len), _key = 0; _key < _len; _key++) {\n    fns[_key] = arguments[_key];\n  }\n\n  return function () {\n    for (var _len2 = arguments.length, args = Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n      args[_key2] = arguments[_key2];\n    } // eslint-disable-line\n    // eslint-disable-line\n\n\n    for (var i = 0; i < fns.length; i++) {\n      if (fns[i] && typeof fns[i] === 'function') {\n        fns[i].apply(this, args);\n      }\n    }\n  };\n}\n\nvar Select = function (_React$Component) {\n  _inherits(Select, _React$Component);\n\n  function Select(props) {\n    _classCallCheck(this, Select);\n\n    var _this = _possibleConstructorReturn(this, _React$Component.call(this, props));\n\n    _initialiseProps.call(_this);\n\n    var value = _this.getValueFromProps(props);\n\n    var optionsInfo = _this.getOptionsInfoFromProps(props);\n\n    var inputValue = '';\n\n    if (props.combobox) {\n      inputValue = value.length ? _this.getLabelBySingleValue(value[0], optionsInfo) : '';\n    }\n\n    var open = props.open;\n\n    if (open === undefined) {\n      open = props.defaultOpen;\n    }\n\n    _this.state = {\n      value: value,\n      inputValue: inputValue,\n      open: open,\n      optionsInfo: optionsInfo\n    };\n\n    _this.adjustOpenState();\n\n    return _this;\n  }\n\n  Select.prototype.componentDidMount = function componentDidMount() {\n    if (this.props.autoFocus) {\n      this.focus();\n    }\n  };\n\n  Select.prototype.componentWillUpdate = function componentWillUpdate(nextProps, nextState) {\n    this.props = nextProps;\n    this.state = nextState;\n    this.adjustOpenState();\n  };\n\n  Select.prototype.componentDidUpdate = function componentDidUpdate() {\n    if (isMultipleOrTags(this.props)) {\n      var inputNode = this.getInputDOMNode();\n      var mirrorNode = this.getInputMirrorDOMNode();\n\n      if (inputNode.value) {\n        inputNode.style.width = '';\n        inputNode.style.width = mirrorNode.clientWidth + 'px';\n      } else {\n        inputNode.style.width = '';\n      }\n    }\n  };\n\n  Select.prototype.componentWillUnmount = function componentWillUnmount() {\n    this.clearFocusTime();\n    this.clearBlurTime();\n    this.clearAdjustTimer();\n\n    if (this.dropdownContainer) {\n      ReactDOM.unmountComponentAtNode(this.dropdownContainer);\n      document.body.removeChild(this.dropdownContainer);\n      this.dropdownContainer = null;\n    }\n  }; // combobox ignore\n\n\n  Select.prototype.focus = function focus() {\n    if (isSingleMode(this.props)) {\n      this.selectionRef.focus();\n    } else {\n      this.getInputDOMNode().focus();\n    }\n  };\n\n  Select.prototype.blur = function blur() {\n    if (isSingleMode(this.props)) {\n      this.selectionRef.blur();\n    } else {\n      this.getInputDOMNode().blur();\n    }\n  };\n\n  Select.prototype.renderClear = function renderClear() {\n    var _props = this.props,\n        prefixCls = _props.prefixCls,\n        allowClear = _props.allowClear;\n    var _state = this.state,\n        value = _state.value,\n        inputValue = _state.inputValue;\n    var clear = React.createElement('span', _extends({\n      key: 'clear',\n      onMouseDown: preventDefaultEvent,\n      style: UNSELECTABLE_STYLE\n    }, UNSELECTABLE_ATTRIBUTE, {\n      className: prefixCls + '-selection__clear',\n      onClick: this.onClearSelection\n    }));\n\n    if (!allowClear) {\n      return null;\n    }\n\n    if (isCombobox(this.props)) {\n      if (inputValue) {\n        return clear;\n      }\n\n      return null;\n    }\n\n    if (inputValue || value.length) {\n      return clear;\n    }\n\n    return null;\n  };\n\n  Select.prototype.render = function render() {\n    var _rootCls;\n\n    var props = this.props;\n    var multiple = isMultipleOrTags(props);\n    var state = this.state;\n    var className = props.className,\n        disabled = props.disabled,\n        prefixCls = props.prefixCls;\n    var ctrlNode = this.renderTopControlNode();\n    var extraSelectionProps = {};\n    var open = this.state.open;\n    var options = this._options;\n\n    if (!isMultipleOrTagsOrCombobox(props)) {\n      extraSelectionProps = {\n        onKeyDown: this.onKeyDown,\n        tabIndex: props.disabled ? -1 : 0\n      };\n    }\n\n    var rootCls = (_rootCls = {}, _rootCls[className] = !!className, _rootCls[prefixCls] = 1, _rootCls[prefixCls + '-open'] = open, _rootCls[prefixCls + '-focused'] = open || !!this._focused, _rootCls[prefixCls + '-combobox'] = isCombobox(props), _rootCls[prefixCls + '-disabled'] = disabled, _rootCls[prefixCls + '-enabled'] = !disabled, _rootCls[prefixCls + '-allow-clear'] = !!props.allowClear, _rootCls);\n    return React.createElement(SelectTrigger, {\n      onPopupFocus: this.onPopupFocus,\n      onMouseEnter: this.props.onMouseEnter,\n      onMouseLeave: this.props.onMouseLeave,\n      dropdownAlign: props.dropdownAlign,\n      dropdownClassName: props.dropdownClassName,\n      dropdownMatchSelectWidth: props.dropdownMatchSelectWidth,\n      defaultActiveFirstOption: props.defaultActiveFirstOption,\n      dropdownMenuStyle: props.dropdownMenuStyle,\n      transitionName: props.transitionName,\n      animation: props.animation,\n      prefixCls: props.prefixCls,\n      dropdownStyle: props.dropdownStyle,\n      combobox: props.combobox,\n      showSearch: props.showSearch,\n      options: options,\n      multiple: multiple,\n      disabled: disabled,\n      visible: open,\n      inputValue: state.inputValue,\n      value: state.value,\n      backfillValue: state.backfillValue,\n      firstActiveValue: props.firstActiveValue,\n      onDropdownVisibleChange: this.onDropdownVisibleChange,\n      getPopupContainer: props.getPopupContainer,\n      onMenuSelect: this.onMenuSelect,\n      onMenuDeselect: this.onMenuDeselect,\n      onPopupScroll: props.onPopupScroll,\n      showAction: props.showAction,\n      ref: saveRef(this, 'selectTriggerRef')\n    }, React.createElement('div', {\n      style: props.style,\n      ref: saveRef(this, 'rootRef'),\n      onBlur: this.onOuterBlur,\n      onFocus: this.onOuterFocus,\n      className: classnames(rootCls)\n    }, React.createElement('div', _extends({\n      ref: saveRef(this, 'selectionRef'),\n      key: 'selection',\n      className: prefixCls + '-selection\\n            ' + prefixCls + '-selection--' + (multiple ? 'multiple' : 'single'),\n      role: 'combobox',\n      'aria-autocomplete': 'list',\n      'aria-haspopup': 'true',\n      'aria-expanded': open\n    }, extraSelectionProps), ctrlNode, this.renderClear(), multiple || !props.showArrow ? null : React.createElement('span', _extends({\n      key: 'arrow',\n      className: prefixCls + '-arrow',\n      style: UNSELECTABLE_STYLE\n    }, UNSELECTABLE_ATTRIBUTE, {\n      onClick: this.onArrowClick\n    }), React.createElement('b', null)))));\n  };\n\n  return Select;\n}(React.Component);\n\nSelect.propTypes = SelectPropTypes;\nSelect.defaultProps = {\n  prefixCls: 'rc-select',\n  defaultOpen: false,\n  labelInValue: false,\n  defaultActiveFirstOption: true,\n  showSearch: true,\n  allowClear: false,\n  placeholder: '',\n  onChange: noop,\n  onFocus: noop,\n  onBlur: noop,\n  onSelect: noop,\n  onSearch: noop,\n  onDeselect: noop,\n  onInputKeyDown: noop,\n  showArrow: true,\n  dropdownMatchSelectWidth: true,\n  dropdownStyle: {},\n  dropdownMenuStyle: {},\n  optionFilterProp: 'value',\n  optionLabelProp: 'value',\n  notFoundContent: 'Not Found',\n  backfill: false,\n  showAction: ['click'],\n  tokenSeparators: []\n};\n\nvar _initialiseProps = function _initialiseProps() {\n  var _this2 = this;\n\n  this.componentWillReceiveProps = function (nextProps) {\n    var optionsInfo = _this2.getOptionsInfoFromProps(nextProps);\n\n    _this2.setState({\n      optionsInfo: optionsInfo\n    });\n\n    if ('value' in nextProps) {\n      var value = _this2.getValueFromProps(nextProps);\n\n      _this2.setState({\n        value: value\n      }, _this2.forcePopupAlign);\n\n      if (nextProps.combobox) {\n        _this2.setState({\n          inputValue: value.length ? _this2.getLabelBySingleValue(value[0], optionsInfo) : ''\n        });\n      }\n    }\n  };\n\n  this.onInputChange = function (event) {\n    var tokenSeparators = _this2.props.tokenSeparators;\n    var val = event.target.value;\n\n    if (isMultipleOrTags(_this2.props) && tokenSeparators.length && includesSeparators(val, tokenSeparators)) {\n      var nextValue = _this2.getValueByInput(val);\n\n      if (nextValue !== undefined) {\n        _this2.fireChange(nextValue);\n      }\n\n      _this2.setOpenState(false, true);\n\n      _this2.setInputValue('', false);\n\n      return;\n    }\n\n    _this2.setInputValue(val);\n\n    _this2.setState({\n      open: true\n    });\n\n    if (isCombobox(_this2.props)) {\n      _this2.fireChange([val]);\n    }\n  };\n\n  this.onDropdownVisibleChange = function (open) {\n    if (open && !_this2._focused) {\n      _this2.clearBlurTime();\n\n      _this2.timeoutFocus();\n\n      _this2._focused = true;\n\n      _this2.updateFocusClassName();\n    }\n\n    _this2.setOpenState(open);\n  };\n\n  this.onKeyDown = function (event) {\n    var props = _this2.props;\n\n    if (props.disabled) {\n      return;\n    }\n\n    var keyCode = event.keyCode;\n\n    if (_this2.state.open && !_this2.getInputDOMNode()) {\n      _this2.onInputKeyDown(event);\n    } else if (keyCode === KeyCode.ENTER || keyCode === KeyCode.DOWN) {\n      _this2.setOpenState(true);\n\n      event.preventDefault();\n    }\n  };\n\n  this.onInputKeyDown = function (event) {\n    var props = _this2.props;\n\n    if (props.disabled) {\n      return;\n    }\n\n    var state = _this2.state;\n    var keyCode = event.keyCode;\n\n    if (isMultipleOrTags(props) && !event.target.value && keyCode === KeyCode.BACKSPACE) {\n      event.preventDefault();\n      var value = state.value;\n\n      if (value.length) {\n        _this2.removeSelected(value[value.length - 1]);\n      }\n\n      return;\n    }\n\n    if (keyCode === KeyCode.DOWN) {\n      if (!state.open) {\n        _this2.openIfHasChildren();\n\n        event.preventDefault();\n        event.stopPropagation();\n        return;\n      }\n    } else if (keyCode === KeyCode.ESC) {\n      if (state.open) {\n        _this2.setOpenState(false);\n\n        event.preventDefault();\n        event.stopPropagation();\n      }\n\n      return;\n    }\n\n    if (state.open) {\n      var menu = _this2.selectTriggerRef.getInnerMenu();\n\n      if (menu && menu.onKeyDown(event, _this2.handleBackfill)) {\n        event.preventDefault();\n        event.stopPropagation();\n      }\n    }\n  };\n\n  this.onMenuSelect = function (_ref) {\n    var item = _ref.item;\n    var value = _this2.state.value;\n    var props = _this2.props;\n    var selectedValue = getValuePropValue(item);\n    var lastValue = value[value.length - 1];\n\n    _this2.fireSelect(selectedValue);\n\n    if (isMultipleOrTags(props)) {\n      if (findIndexInValueBySingleValue(value, selectedValue) !== -1) {\n        return;\n      }\n\n      value = value.concat([selectedValue]);\n    } else {\n      if (isCombobox(props)) {\n        _this2.skipAdjustOpen = true;\n\n        _this2.clearAdjustTimer();\n\n        _this2.skipAdjustOpenTimer = setTimeout(function () {\n          _this2.skipAdjustOpen = false;\n        }, 0);\n      }\n\n      if (lastValue && lastValue === selectedValue && selectedValue !== _this2.state.backfillValue) {\n        _this2.setOpenState(false, true);\n\n        return;\n      }\n\n      value = [selectedValue];\n\n      _this2.setOpenState(false, true);\n    }\n\n    _this2.fireChange(value);\n\n    var inputValue = void 0;\n\n    if (isCombobox(props)) {\n      inputValue = getPropValue(item, props.optionLabelProp);\n    } else {\n      inputValue = '';\n    }\n\n    _this2.setInputValue(inputValue, false);\n  };\n\n  this.onMenuDeselect = function (_ref2) {\n    var item = _ref2.item,\n        domEvent = _ref2.domEvent;\n\n    if (domEvent.type === 'click') {\n      _this2.removeSelected(getValuePropValue(item));\n    }\n\n    _this2.setInputValue('', false);\n  };\n\n  this.onArrowClick = function (e) {\n    e.stopPropagation();\n    e.preventDefault();\n\n    if (!_this2.props.disabled) {\n      _this2.setOpenState(!_this2.state.open, !_this2.state.open);\n    }\n  };\n\n  this.onPlaceholderClick = function () {\n    if (_this2.getInputDOMNode()) {\n      _this2.getInputDOMNode().focus();\n    }\n  };\n\n  this.onOuterFocus = function (e) {\n    if (_this2.props.disabled) {\n      e.preventDefault();\n      return;\n    }\n\n    _this2.clearBlurTime();\n\n    if (!isMultipleOrTagsOrCombobox(_this2.props) && e.target === _this2.getInputDOMNode()) {\n      return;\n    }\n\n    if (_this2._focused) {\n      return;\n    }\n\n    _this2._focused = true;\n\n    _this2.updateFocusClassName();\n\n    _this2.timeoutFocus();\n  };\n\n  this.onPopupFocus = function () {\n    // fix ie scrollbar, focus element again\n    _this2.maybeFocus(true, true);\n  };\n\n  this.onOuterBlur = function (e) {\n    if (_this2.props.disabled) {\n      e.preventDefault();\n      return;\n    }\n\n    _this2.blurTimer = setTimeout(function () {\n      _this2._focused = false;\n\n      _this2.updateFocusClassName();\n\n      var props = _this2.props;\n      var value = _this2.state.value;\n      var inputValue = _this2.state.inputValue;\n\n      if (isSingleMode(props) && props.showSearch && inputValue && props.defaultActiveFirstOption) {\n        var options = _this2._options || [];\n\n        if (options.length) {\n          var firstOption = findFirstMenuItem(options);\n\n          if (firstOption) {\n            value = [getValuePropValue(firstOption)];\n\n            _this2.fireChange(value);\n          }\n        }\n      } else if (isMultipleOrTags(props) && inputValue) {\n        // why not use setState?\n        _this2.state.inputValue = _this2.getInputDOMNode().value = '';\n        value = _this2.getValueByInput(inputValue);\n\n        if (value !== undefined) {\n          _this2.fireChange(value);\n        }\n      }\n\n      props.onBlur(_this2.getVLForOnChange(value));\n\n      _this2.setOpenState(false);\n    }, 10);\n  };\n\n  this.onClearSelection = function (event) {\n    var props = _this2.props;\n    var state = _this2.state;\n\n    if (props.disabled) {\n      return;\n    }\n\n    var inputValue = state.inputValue,\n        value = state.value;\n    event.stopPropagation();\n\n    if (inputValue || value.length) {\n      if (value.length) {\n        _this2.fireChange([]);\n      }\n\n      _this2.setOpenState(false, true);\n\n      if (inputValue) {\n        _this2.setInputValue('');\n      }\n    }\n  };\n\n  this.onChoiceAnimationLeave = function () {\n    _this2.forcePopupAlign();\n  };\n\n  this.getValueFromProps = function (props) {\n    var value = [];\n\n    if ('value' in props) {\n      value = toArray(props.value);\n    } else {\n      value = toArray(props.defaultValue);\n    }\n\n    if (props.labelInValue) {\n      value = value.map(function (v) {\n        return v.key;\n      });\n    }\n\n    return value;\n  };\n\n  this.getOptionsInfoFromProps = function (props) {\n    var options = _this2.getOptionsFromChildren(props.children);\n\n    var oldOptionsInfo = _this2.state ? _this2.state.optionsInfo : {};\n    var value = _this2.state ? _this2.state.value : [];\n    var optionsInfo = {};\n    options.forEach(function (option) {\n      var singleValue = getValuePropValue(option);\n      optionsInfo[getMapKey(singleValue)] = {\n        option: option,\n        value: singleValue,\n        label: _this2.getLabelFromOption(option),\n        title: option.props.title\n      };\n    });\n    value.forEach(function (v) {\n      var key = getMapKey(v);\n\n      if (!optionsInfo[key]) {\n        optionsInfo[key] = oldOptionsInfo[key];\n      }\n    });\n    return optionsInfo;\n  };\n\n  this.getOptionInfoBySingleValue = function (value, optionsInfo) {\n    var info = void 0;\n    optionsInfo = optionsInfo || _this2.state.optionsInfo;\n\n    if (optionsInfo[getMapKey(value)]) {\n      info = optionsInfo[getMapKey(value)];\n    }\n\n    if (info) {\n      return info;\n    }\n\n    var defaultLabel = value;\n\n    if (_this2.props.labelInValue) {\n      var label = getLabelFromPropsValue(_this2.props.value, value);\n\n      if (label !== undefined) {\n        defaultLabel = label;\n      }\n    }\n\n    var defaultInfo = {\n      option: React.createElement(Option, {\n        value: value,\n        key: value\n      }, value),\n      value: value,\n      label: defaultLabel\n    };\n    return defaultInfo;\n  };\n\n  this.getOptionBySingleValue = function (value) {\n    var _getOptionInfoBySingl = _this2.getOptionInfoBySingleValue(value),\n        option = _getOptionInfoBySingl.option;\n\n    return option;\n  };\n\n  this.getOptionsBySingleValue = function (values) {\n    return values.map(function (value) {\n      return _this2.getOptionBySingleValue(value);\n    });\n  };\n\n  this.getOptionsFromChildren = function (children) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n    React.Children.forEach(children, function (child) {\n      if (!child) {\n        return;\n      }\n\n      if (child.type.isSelectOptGroup) {\n        _this2.getOptionsFromChildren(child.props.children, options);\n      } else {\n        options.push(child);\n      }\n    });\n    return options;\n  };\n\n  this.getValueByLabel = function (label) {\n    if (label === undefined) {\n      return null;\n    }\n\n    var value = null;\n    Object.keys(_this2.state.optionsInfo).forEach(function (key) {\n      var info = _this2.state.optionsInfo[key];\n\n      if (toArray(info.label).join('') === label) {\n        value = info.value;\n      }\n    });\n    return value;\n  };\n\n  this.getLabelFromOption = function (option) {\n    return getPropValue(option, _this2.props.optionLabelProp);\n  };\n\n  this.getVLBySingleValue = function (value) {\n    if (_this2.props.labelInValue) {\n      return {\n        key: value,\n        label: _this2.getLabelBySingleValue(value)\n      };\n    }\n\n    return value;\n  };\n\n  this.getVLForOnChange = function (vls_) {\n    var vls = vls_;\n\n    if (vls !== undefined) {\n      if (!_this2.props.labelInValue) {\n        vls = vls.map(function (v) {\n          return v;\n        });\n      } else {\n        vls = vls.map(function (vl) {\n          return {\n            key: vl,\n            label: _this2.getLabelBySingleValue(vl)\n          };\n        });\n      }\n\n      return isMultipleOrTags(_this2.props) ? vls : vls[0];\n    }\n\n    return vls;\n  };\n\n  this.getLabelBySingleValue = function (value, optionsInfo) {\n    var _getOptionInfoBySingl2 = _this2.getOptionInfoBySingleValue(value, optionsInfo),\n        label = _getOptionInfoBySingl2.label;\n\n    return label;\n  };\n\n  this.getDropdownContainer = function () {\n    if (!_this2.dropdownContainer) {\n      _this2.dropdownContainer = document.createElement('div');\n      document.body.appendChild(_this2.dropdownContainer);\n    }\n\n    return _this2.dropdownContainer;\n  };\n\n  this.getPlaceholderElement = function () {\n    var props = _this2.props,\n        state = _this2.state;\n    var hidden = false;\n\n    if (state.inputValue) {\n      hidden = true;\n    }\n\n    if (state.value.length) {\n      hidden = true;\n    }\n\n    if (isCombobox(props) && state.value.length === 1 && !state.value[0]) {\n      hidden = false;\n    }\n\n    var placeholder = props.placeholder;\n\n    if (placeholder) {\n      return React.createElement('div', _extends({\n        onMouseDown: preventDefaultEvent,\n        style: _extends({\n          display: hidden ? 'none' : 'block'\n        }, UNSELECTABLE_STYLE)\n      }, UNSELECTABLE_ATTRIBUTE, {\n        onClick: _this2.onPlaceholderClick,\n        className: props.prefixCls + '-selection__placeholder'\n      }), placeholder);\n    }\n\n    return null;\n  };\n\n  this.getInputElement = function () {\n    var _classnames;\n\n    var props = _this2.props;\n    var inputElement = props.getInputElement ? props.getInputElement() : React.createElement('input', {\n      id: props.id,\n      autoComplete: 'off'\n    });\n    var inputCls = classnames(inputElement.props.className, (_classnames = {}, _classnames[props.prefixCls + '-search__field'] = true, _classnames)); // https://github.com/ant-design/ant-design/issues/4992#issuecomment-281542159\n    // Add space to the end of the inputValue as the width measurement tolerance\n\n    return React.createElement('div', {\n      className: props.prefixCls + '-search__field__wrap'\n    }, React.cloneElement(inputElement, {\n      ref: saveRef(_this2, 'inputRef'),\n      onChange: _this2.onInputChange,\n      onKeyDown: chaining(_this2.onInputKeyDown, inputElement.props.onKeyDown, _this2.props.onInputKeyDown),\n      value: _this2.state.inputValue,\n      disabled: props.disabled,\n      className: inputCls\n    }), React.createElement('span', {\n      ref: saveRef(_this2, 'inputMirrorRef'),\n      className: props.prefixCls + '-search__field__mirror'\n    }, _this2.state.inputValue, '\\xA0'));\n  };\n\n  this.getInputDOMNode = function () {\n    return _this2.topCtrlRef ? _this2.topCtrlRef.querySelector('input,textarea,div[contentEditable]') : _this2.inputRef;\n  };\n\n  this.getInputMirrorDOMNode = function () {\n    return _this2.inputMirrorRef;\n  };\n\n  this.getPopupDOMNode = function () {\n    return _this2.selectTriggerRef.getPopupDOMNode();\n  };\n\n  this.getPopupMenuComponent = function () {\n    return _this2.selectTriggerRef.getInnerMenu();\n  };\n\n  this.setOpenState = function (open, needFocus) {\n    var props = _this2.props,\n        state = _this2.state;\n\n    if (state.open === open) {\n      _this2.maybeFocus(open, needFocus);\n\n      return;\n    }\n\n    var nextState = {\n      open: open,\n      backfillValue: undefined\n    }; // clear search input value when open is false in singleMode.\n\n    if (!open && isSingleMode(props) && props.showSearch) {\n      _this2.setInputValue('');\n    }\n\n    if (!open) {\n      _this2.maybeFocus(open, needFocus);\n    }\n\n    _this2.setState(nextState, function () {\n      if (open) {\n        _this2.maybeFocus(open, needFocus);\n      }\n    });\n  };\n\n  this.setInputValue = function (inputValue) {\n    var fireSearch = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;\n\n    if (inputValue !== _this2.state.inputValue) {\n      _this2.setState({\n        inputValue: inputValue\n      }, _this2.forcePopupAlign);\n\n      if (fireSearch) {\n        _this2.props.onSearch(inputValue);\n      }\n    }\n  };\n\n  this.getValueByInput = function (string) {\n    var _props2 = _this2.props,\n        multiple = _props2.multiple,\n        tokenSeparators = _props2.tokenSeparators;\n    var nextValue = _this2.state.value;\n    var hasNewValue = false;\n    splitBySeparators(string, tokenSeparators).forEach(function (label) {\n      var selectedValue = [label];\n\n      if (multiple) {\n        var value = _this2.getValueByLabel(label);\n\n        if (value && findIndexInValueBySingleValue(nextValue, value) === -1) {\n          nextValue = nextValue.concat(value);\n          hasNewValue = true;\n\n          _this2.fireSelect(value);\n        }\n      } else {\n        // tag\n        if (findIndexInValueBySingleValue(nextValue, label) === -1) {\n          nextValue = nextValue.concat(selectedValue);\n          hasNewValue = true;\n\n          _this2.fireSelect(label);\n        }\n      }\n    });\n    return hasNewValue ? nextValue : undefined;\n  };\n\n  this.handleBackfill = function (item) {\n    if (!_this2.props.backfill || !(isSingleMode(_this2.props) || isCombobox(_this2.props))) {\n      return;\n    }\n\n    var key = getValuePropValue(item);\n\n    if (isCombobox(_this2.props)) {\n      _this2.setInputValue(key, false);\n    }\n\n    _this2.setState({\n      value: [key],\n      backfillValue: key\n    });\n  };\n\n  this.filterOption = function (input, child) {\n    var defaultFilter = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : defaultFilterFn;\n    var value = _this2.state.value;\n    var lastValue = value[value.length - 1];\n\n    if (!input || lastValue && lastValue === _this2.state.backfillValue) {\n      return true;\n    }\n\n    var filterFn = _this2.props.filterOption;\n\n    if ('filterOption' in _this2.props) {\n      if (_this2.props.filterOption === true) {\n        filterFn = defaultFilter;\n      }\n    } else {\n      filterFn = defaultFilter;\n    }\n\n    if (!filterFn) {\n      return true;\n    } else if (typeof filterFn === 'function') {\n      return filterFn.call(_this2, input, child);\n    } else if (child.props.disabled) {\n      return false;\n    }\n\n    return true;\n  };\n\n  this.timeoutFocus = function () {\n    if (_this2.focusTimer) {\n      _this2.clearFocusTime();\n    }\n\n    _this2.focusTimer = setTimeout(function () {\n      _this2.props.onFocus();\n    }, 10);\n  };\n\n  this.clearFocusTime = function () {\n    if (_this2.focusTimer) {\n      clearTimeout(_this2.focusTimer);\n      _this2.focusTimer = null;\n    }\n  };\n\n  this.clearBlurTime = function () {\n    if (_this2.blurTimer) {\n      clearTimeout(_this2.blurTimer);\n      _this2.blurTimer = null;\n    }\n  };\n\n  this.clearAdjustTimer = function () {\n    if (_this2.skipAdjustOpenTimer) {\n      clearTimeout(_this2.skipAdjustOpenTimer);\n      _this2.skipAdjustOpenTimer = null;\n    }\n  };\n\n  this.updateFocusClassName = function () {\n    var rootRef = _this2.rootRef,\n        props = _this2.props; // avoid setState and its side effect\n\n    if (_this2._focused) {\n      classes(rootRef).add(props.prefixCls + '-focused');\n    } else {\n      classes(rootRef).remove(props.prefixCls + '-focused');\n    }\n  };\n\n  this.maybeFocus = function (open, needFocus) {\n    if (needFocus || open) {\n      var input = _this2.getInputDOMNode();\n\n      var _document = document,\n          activeElement = _document.activeElement;\n\n      if (input && (open || isMultipleOrTagsOrCombobox(_this2.props))) {\n        if (activeElement !== input) {\n          input.focus();\n          _this2._focused = true;\n        }\n      } else {\n        if (activeElement !== _this2.selectionRef) {\n          _this2.selectionRef.focus();\n\n          _this2._focused = true;\n        }\n      }\n    }\n  };\n\n  this.removeSelected = function (selectedKey) {\n    var props = _this2.props;\n\n    if (props.disabled || _this2.isChildDisabled(selectedKey)) {\n      return;\n    }\n\n    var value = _this2.state.value.filter(function (singleValue) {\n      return singleValue !== selectedKey;\n    });\n\n    var canMultiple = isMultipleOrTags(props);\n\n    if (canMultiple) {\n      var event = selectedKey;\n\n      if (props.labelInValue) {\n        event = {\n          key: selectedKey,\n          label: _this2.getLabelBySingleValue(selectedKey)\n        };\n      }\n\n      props.onDeselect(event, _this2.getOptionBySingleValue(selectedKey));\n    }\n\n    _this2.fireChange(value);\n  };\n\n  this.openIfHasChildren = function () {\n    var props = _this2.props;\n\n    if (React.Children.count(props.children) || isSingleMode(props)) {\n      _this2.setOpenState(true);\n    }\n  };\n\n  this.fireSelect = function (value) {\n    _this2.props.onSelect(_this2.getVLBySingleValue(value), _this2.getOptionBySingleValue(value));\n  };\n\n  this.fireChange = function (value) {\n    var props = _this2.props;\n\n    if (!('value' in props)) {\n      _this2.setState({\n        value: value\n      }, _this2.forcePopupAlign);\n    }\n\n    var vls = _this2.getVLForOnChange(value);\n\n    var options = _this2.getOptionsBySingleValue(value);\n\n    props.onChange(vls, isMultipleOrTags(_this2.props) ? options : options[0]);\n  };\n\n  this.isChildDisabled = function (key) {\n    return childrenToArray(_this2.props.children).some(function (child) {\n      var childValue = getValuePropValue(child);\n      return childValue === key && child.props && child.props.disabled;\n    });\n  };\n\n  this.adjustOpenState = function () {\n    if (_this2.skipAdjustOpen) {\n      return;\n    }\n\n    var open = _this2.state.open;\n    var options = []; // If hidden menu due to no options, then it should be calculated again\n\n    if (open || _this2.hiddenForNoOptions) {\n      options = _this2.renderFilterOptions();\n    }\n\n    _this2._options = options;\n\n    if (isMultipleOrTagsOrCombobox(_this2.props) || !_this2.props.showSearch) {\n      if (open && !options.length) {\n        open = false;\n        _this2.hiddenForNoOptions = true;\n      } // Keep menu open if there are options and hidden for no options before\n\n\n      if (_this2.hiddenForNoOptions && options.length) {\n        open = true;\n        _this2.hiddenForNoOptions = false;\n      }\n    }\n\n    _this2.state.open = open;\n  };\n\n  this.forcePopupAlign = function () {\n    _this2.selectTriggerRef.triggerRef.forcePopupAlign();\n  };\n\n  this.renderFilterOptions = function () {\n    var inputValue = _this2.state.inputValue;\n    var _props3 = _this2.props,\n        children = _props3.children,\n        tags = _props3.tags,\n        filterOption = _props3.filterOption,\n        notFoundContent = _props3.notFoundContent;\n    var menuItems = [];\n    var childrenKeys = [];\n\n    var options = _this2.renderFilterOptionsFromChildren(children, childrenKeys, menuItems);\n\n    if (tags) {\n      // tags value must be string\n      var value = _this2.state.value || [];\n      value = value.filter(function (singleValue) {\n        return childrenKeys.indexOf(singleValue) === -1 && (!inputValue || String(singleValue).indexOf(String(inputValue)) > -1);\n      });\n      value.forEach(function (singleValue) {\n        var key = singleValue;\n        var menuItem = React.createElement(MenuItem, {\n          style: UNSELECTABLE_STYLE,\n          attribute: UNSELECTABLE_ATTRIBUTE,\n          value: key,\n          key: key\n        }, key);\n        options.push(menuItem);\n        menuItems.push(menuItem);\n      });\n\n      if (inputValue) {\n        var notFindInputItem = menuItems.every(function (option) {\n          // this.filterOption return true has two meaning,\n          // 1, some one exists after filtering\n          // 2, filterOption is set to false\n          // condition 2 does not mean the option has same value with inputValue\n          var filterFn = function filterFn() {\n            return getValuePropValue(option) === inputValue;\n          };\n\n          if (filterOption !== false) {\n            return !_this2.filterOption.call(_this2, inputValue, option, filterFn);\n          }\n\n          return !filterFn();\n        });\n\n        if (notFindInputItem) {\n          options.unshift(React.createElement(MenuItem, {\n            style: UNSELECTABLE_STYLE,\n            attribute: UNSELECTABLE_ATTRIBUTE,\n            value: inputValue,\n            key: inputValue\n          }, inputValue));\n        }\n      }\n    }\n\n    if (!options.length && notFoundContent) {\n      options = [React.createElement(MenuItem, {\n        style: UNSELECTABLE_STYLE,\n        attribute: UNSELECTABLE_ATTRIBUTE,\n        disabled: true,\n        value: 'NOT_FOUND',\n        key: 'NOT_FOUND'\n      }, notFoundContent)];\n    }\n\n    return options;\n  };\n\n  this.renderFilterOptionsFromChildren = function (children, childrenKeys, menuItems) {\n    var sel = [];\n    var props = _this2.props;\n    var inputValue = _this2.state.inputValue;\n    var tags = props.tags;\n    React.Children.forEach(children, function (child) {\n      if (!child) {\n        return;\n      }\n\n      if (child.type.isSelectOptGroup) {\n        var innerItems = _this2.renderFilterOptionsFromChildren(child.props.children, childrenKeys, menuItems);\n\n        if (innerItems.length) {\n          var label = child.props.label;\n          var key = child.key;\n\n          if (!key && typeof label === 'string') {\n            key = label;\n          } else if (!label && key) {\n            label = key;\n          }\n\n          sel.push(React.createElement(MenuItemGroup, {\n            key: key,\n            title: label\n          }, innerItems));\n        }\n\n        return;\n      }\n\n      warning(child.type.isSelectOption, 'the children of `Select` should be `Select.Option` or `Select.OptGroup`, ' + ('instead of `' + (child.type.name || child.type.displayName || child.type) + '`.'));\n      var childValue = getValuePropValue(child);\n      validateOptionValue(childValue, _this2.props);\n\n      if (_this2.filterOption(inputValue, child)) {\n        var menuItem = React.createElement(MenuItem, _extends({\n          style: UNSELECTABLE_STYLE,\n          attribute: UNSELECTABLE_ATTRIBUTE,\n          value: childValue,\n          key: childValue\n        }, child.props));\n        sel.push(menuItem);\n        menuItems.push(menuItem);\n      }\n\n      if (tags && !child.props.disabled) {\n        childrenKeys.push(childValue);\n      }\n    });\n    return sel;\n  };\n\n  this.renderTopControlNode = function () {\n    var _state2 = _this2.state,\n        value = _state2.value,\n        open = _state2.open,\n        inputValue = _state2.inputValue;\n    var props = _this2.props;\n    var choiceTransitionName = props.choiceTransitionName,\n        prefixCls = props.prefixCls,\n        maxTagTextLength = props.maxTagTextLength,\n        maxTagCount = props.maxTagCount,\n        maxTagPlaceholder = props.maxTagPlaceholder,\n        showSearch = props.showSearch;\n    var className = prefixCls + '-selection__rendered'; // search input is inside topControlNode in single, multiple & combobox. 2016/04/13\n\n    var innerNode = null;\n\n    if (isSingleMode(props)) {\n      var selectedValue = null;\n\n      if (value.length) {\n        var showSelectedValue = false;\n        var opacity = 1;\n\n        if (!showSearch) {\n          showSelectedValue = true;\n        } else {\n          if (open) {\n            showSelectedValue = !inputValue;\n\n            if (showSelectedValue) {\n              opacity = 0.4;\n            }\n          } else {\n            showSelectedValue = true;\n          }\n        }\n\n        var singleValue = value[0];\n\n        var _getOptionInfoBySingl3 = _this2.getOptionInfoBySingleValue(singleValue),\n            label = _getOptionInfoBySingl3.label,\n            title = _getOptionInfoBySingl3.title;\n\n        selectedValue = React.createElement('div', {\n          key: 'value',\n          className: prefixCls + '-selection-selected-value',\n          title: title || label,\n          style: {\n            display: showSelectedValue ? 'block' : 'none',\n            opacity: opacity\n          }\n        }, label);\n      }\n\n      if (!showSearch) {\n        innerNode = [selectedValue];\n      } else {\n        innerNode = [selectedValue, React.createElement('div', {\n          className: prefixCls + '-search ' + prefixCls + '-search--inline',\n          key: 'input',\n          style: {\n            display: open ? 'block' : 'none'\n          }\n        }, _this2.getInputElement())];\n      }\n    } else {\n      var selectedValueNodes = [];\n      var limitedCountValue = value;\n      var maxTagPlaceholderEl = void 0;\n\n      if (maxTagCount !== undefined && value.length > maxTagCount) {\n        limitedCountValue = limitedCountValue.slice(0, maxTagCount);\n\n        var omittedValues = _this2.getVLForOnChange(value.slice(maxTagCount, value.length));\n\n        var content = '+ ' + (value.length - maxTagCount) + ' ...';\n\n        if (maxTagPlaceholder) {\n          content = typeof maxTagPlaceholder === 'function' ? maxTagPlaceholder(omittedValues) : maxTagPlaceholder;\n        }\n\n        maxTagPlaceholderEl = React.createElement('li', _extends({\n          style: UNSELECTABLE_STYLE\n        }, UNSELECTABLE_ATTRIBUTE, {\n          onMouseDown: preventDefaultEvent,\n          className: prefixCls + '-selection__choice ' + prefixCls + '-selection__choice__disabled',\n          key: 'maxTagPlaceholder',\n          title: content\n        }), React.createElement('div', {\n          className: prefixCls + '-selection__choice__content'\n        }, content));\n      }\n\n      if (isMultipleOrTags(props)) {\n        selectedValueNodes = limitedCountValue.map(function (singleValue) {\n          var info = _this2.getOptionInfoBySingleValue(singleValue);\n\n          var content = info.label;\n          var title = info.title || content;\n\n          if (maxTagTextLength && typeof content === 'string' && content.length > maxTagTextLength) {\n            content = content.slice(0, maxTagTextLength) + '...';\n          }\n\n          var disabled = _this2.isChildDisabled(singleValue);\n\n          var choiceClassName = disabled ? prefixCls + '-selection__choice ' + prefixCls + '-selection__choice__disabled' : prefixCls + '-selection__choice';\n          return React.createElement('li', _extends({\n            style: UNSELECTABLE_STYLE\n          }, UNSELECTABLE_ATTRIBUTE, {\n            onMouseDown: preventDefaultEvent,\n            className: choiceClassName,\n            key: singleValue,\n            title: title\n          }), React.createElement('div', {\n            className: prefixCls + '-selection__choice__content'\n          }, content), disabled ? null : React.createElement('span', {\n            className: prefixCls + '-selection__choice__remove',\n            onClick: _this2.removeSelected.bind(_this2, singleValue)\n          }));\n        });\n      }\n\n      if (maxTagPlaceholderEl) {\n        selectedValueNodes.push(maxTagPlaceholderEl);\n      }\n\n      selectedValueNodes.push(React.createElement('li', {\n        className: prefixCls + '-search ' + prefixCls + '-search--inline',\n        key: '__input'\n      }, _this2.getInputElement()));\n\n      if (isMultipleOrTags(props) && choiceTransitionName) {\n        innerNode = React.createElement(Animate, {\n          onLeave: _this2.onChoiceAnimationLeave,\n          component: 'ul',\n          transitionName: choiceTransitionName\n        }, selectedValueNodes);\n      } else {\n        innerNode = React.createElement('ul', null, selectedValueNodes);\n      }\n    }\n\n    return React.createElement('div', {\n      className: className,\n      ref: saveRef(_this2, 'topCtrlRef')\n    }, _this2.getPlaceholderElement(), innerNode);\n  };\n};\n\nexport default Select;\nSelect.displayName = 'Select';","map":{"version":3,"sources":["/Users/administrator/Desktop/DrChain/drchain_frontend/drchain/node_modules/rc-select/es/Select.js"],"names":["_extends","_classCallCheck","_possibleConstructorReturn","_inherits","React","ReactDOM","KeyCode","childrenToArray","classnames","Animate","classes","Item","MenuItem","ItemGroup","MenuItemGroup","warning","Option","getPropValue","getValuePropValue","isCombobox","isMultipleOrTags","isMultipleOrTagsOrCombobox","isSingleMode","toArray","getMapKey","findIndexInValueBySingleValue","getLabelFromPropsValue","UNSELECTABLE_ATTRIBUTE","UNSELECTABLE_STYLE","preventDefaultEvent","findFirstMenuItem","includesSeparators","splitBySeparators","defaultFilterFn","validateOptionValue","saveRef","SelectTrigger","SelectPropTypes","noop","chaining","_len","arguments","length","fns","Array","_key","_len2","args","_key2","i","apply","Select","_React$Component","props","_this","call","_initialiseProps","value","getValueFromProps","optionsInfo","getOptionsInfoFromProps","inputValue","combobox","getLabelBySingleValue","open","undefined","defaultOpen","state","adjustOpenState","prototype","componentDidMount","autoFocus","focus","componentWillUpdate","nextProps","nextState","componentDidUpdate","inputNode","getInputDOMNode","mirrorNode","getInputMirrorDOMNode","style","width","clientWidth","componentWillUnmount","clearFocusTime","clearBlurTime","clearAdjustTimer","dropdownContainer","unmountComponentAtNode","document","body","removeChild","selectionRef","blur","renderClear","_props","prefixCls","allowClear","_state","clear","createElement","key","onMouseDown","className","onClick","onClearSelection","render","_rootCls","multiple","disabled","ctrlNode","renderTopControlNode","extraSelectionProps","options","_options","onKeyDown","tabIndex","rootCls","_focused","onPopupFocus","onMouseEnter","onMouseLeave","dropdownAlign","dropdownClassName","dropdownMatchSelectWidth","defaultActiveFirstOption","dropdownMenuStyle","transitionName","animation","dropdownStyle","showSearch","visible","backfillValue","firstActiveValue","onDropdownVisibleChange","getPopupContainer","onMenuSelect","onMenuDeselect","onPopupScroll","showAction","ref","onBlur","onOuterBlur","onFocus","onOuterFocus","role","showArrow","onArrowClick","Component","propTypes","defaultProps","labelInValue","placeholder","onChange","onSelect","onSearch","onDeselect","onInputKeyDown","optionFilterProp","optionLabelProp","notFoundContent","backfill","tokenSeparators","_this2","componentWillReceiveProps","setState","forcePopupAlign","onInputChange","event","val","target","nextValue","getValueByInput","fireChange","setOpenState","setInputValue","timeoutFocus","updateFocusClassName","keyCode","ENTER","DOWN","preventDefault","BACKSPACE","removeSelected","openIfHasChildren","stopPropagation","ESC","menu","selectTriggerRef","getInnerMenu","handleBackfill","_ref","item","selectedValue","lastValue","fireSelect","concat","skipAdjustOpen","skipAdjustOpenTimer","setTimeout","_ref2","domEvent","type","e","onPlaceholderClick","maybeFocus","blurTimer","firstOption","getVLForOnChange","onChoiceAnimationLeave","defaultValue","map","v","getOptionsFromChildren","children","oldOptionsInfo","forEach","option","singleValue","label","getLabelFromOption","title","getOptionInfoBySingleValue","info","defaultLabel","defaultInfo","getOptionBySingleValue","_getOptionInfoBySingl","getOptionsBySingleValue","values","Children","child","isSelectOptGroup","push","getValueByLabel","Object","keys","join","getVLBySingleValue","vls_","vls","vl","_getOptionInfoBySingl2","getDropdownContainer","appendChild","getPlaceholderElement","hidden","display","getInputElement","_classnames","inputElement","id","autoComplete","inputCls","cloneElement","topCtrlRef","querySelector","inputRef","inputMirrorRef","getPopupDOMNode","getPopupMenuComponent","needFocus","fireSearch","string","_props2","hasNewValue","filterOption","input","defaultFilter","filterFn","focusTimer","clearTimeout","rootRef","add","remove","_document","activeElement","selectedKey","isChildDisabled","filter","canMultiple","count","some","childValue","hiddenForNoOptions","renderFilterOptions","triggerRef","_props3","tags","menuItems","childrenKeys","renderFilterOptionsFromChildren","indexOf","String","menuItem","attribute","notFindInputItem","every","unshift","sel","innerItems","isSelectOption","name","displayName","_state2","choiceTransitionName","maxTagTextLength","maxTagCount","maxTagPlaceholder","innerNode","showSelectedValue","opacity","_getOptionInfoBySingl3","selectedValueNodes","limitedCountValue","maxTagPlaceholderEl","slice","omittedValues","content","choiceClassName","bind","onLeave","component"],"mappings":"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","sourcesContent":["import _extends from 'babel-runtime/helpers/extends';\nimport _classCallCheck from 'babel-runtime/helpers/classCallCheck';\nimport _possibleConstructorReturn from 'babel-runtime/helpers/possibleConstructorReturn';\nimport _inherits from 'babel-runtime/helpers/inherits';\n/* eslint func-names: 1 */\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport KeyCode from 'rc-util/es/KeyCode';\nimport childrenToArray from 'rc-util/es/Children/toArray';\nimport classnames from 'classnames';\nimport Animate from 'rc-animate';\nimport classes from 'component-classes';\nimport { Item as MenuItem, ItemGroup as MenuItemGroup } from 'rc-menu';\nimport warning from 'warning';\nimport Option from './Option';\n\nimport { getPropValue, getValuePropValue, isCombobox, isMultipleOrTags, isMultipleOrTagsOrCombobox, isSingleMode, toArray, getMapKey, findIndexInValueBySingleValue, getLabelFromPropsValue, UNSELECTABLE_ATTRIBUTE, UNSELECTABLE_STYLE, preventDefaultEvent, findFirstMenuItem, includesSeparators, splitBySeparators, defaultFilterFn, validateOptionValue, saveRef } from './util';\nimport SelectTrigger from './SelectTrigger';\nimport { SelectPropTypes } from './PropTypes';\n\nfunction noop() {}\n\nfunction chaining() {\n  for (var _len = arguments.length, fns = Array(_len), _key = 0; _key < _len; _key++) {\n    fns[_key] = arguments[_key];\n  }\n\n  return function () {\n    for (var _len2 = arguments.length, args = Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n      args[_key2] = arguments[_key2];\n    }\n\n    // eslint-disable-line\n    // eslint-disable-line\n    for (var i = 0; i < fns.length; i++) {\n      if (fns[i] && typeof fns[i] === 'function') {\n        fns[i].apply(this, args);\n      }\n    }\n  };\n}\n\nvar Select = function (_React$Component) {\n  _inherits(Select, _React$Component);\n\n  function Select(props) {\n    _classCallCheck(this, Select);\n\n    var _this = _possibleConstructorReturn(this, _React$Component.call(this, props));\n\n    _initialiseProps.call(_this);\n\n    var value = _this.getValueFromProps(props);\n    var optionsInfo = _this.getOptionsInfoFromProps(props);\n    var inputValue = '';\n    if (props.combobox) {\n      inputValue = value.length ? _this.getLabelBySingleValue(value[0], optionsInfo) : '';\n    }\n    var open = props.open;\n    if (open === undefined) {\n      open = props.defaultOpen;\n    }\n    _this.state = {\n      value: value,\n      inputValue: inputValue,\n      open: open,\n      optionsInfo: optionsInfo\n    };\n    _this.adjustOpenState();\n    return _this;\n  }\n\n  Select.prototype.componentDidMount = function componentDidMount() {\n    if (this.props.autoFocus) {\n      this.focus();\n    }\n  };\n\n  Select.prototype.componentWillUpdate = function componentWillUpdate(nextProps, nextState) {\n    this.props = nextProps;\n    this.state = nextState;\n    this.adjustOpenState();\n  };\n\n  Select.prototype.componentDidUpdate = function componentDidUpdate() {\n    if (isMultipleOrTags(this.props)) {\n      var inputNode = this.getInputDOMNode();\n      var mirrorNode = this.getInputMirrorDOMNode();\n      if (inputNode.value) {\n        inputNode.style.width = '';\n        inputNode.style.width = mirrorNode.clientWidth + 'px';\n      } else {\n        inputNode.style.width = '';\n      }\n    }\n  };\n\n  Select.prototype.componentWillUnmount = function componentWillUnmount() {\n    this.clearFocusTime();\n    this.clearBlurTime();\n    this.clearAdjustTimer();\n    if (this.dropdownContainer) {\n      ReactDOM.unmountComponentAtNode(this.dropdownContainer);\n      document.body.removeChild(this.dropdownContainer);\n      this.dropdownContainer = null;\n    }\n  };\n\n  // combobox ignore\n\n\n  Select.prototype.focus = function focus() {\n    if (isSingleMode(this.props)) {\n      this.selectionRef.focus();\n    } else {\n      this.getInputDOMNode().focus();\n    }\n  };\n\n  Select.prototype.blur = function blur() {\n    if (isSingleMode(this.props)) {\n      this.selectionRef.blur();\n    } else {\n      this.getInputDOMNode().blur();\n    }\n  };\n\n  Select.prototype.renderClear = function renderClear() {\n    var _props = this.props,\n        prefixCls = _props.prefixCls,\n        allowClear = _props.allowClear;\n    var _state = this.state,\n        value = _state.value,\n        inputValue = _state.inputValue;\n\n    var clear = React.createElement('span', _extends({\n      key: 'clear',\n      onMouseDown: preventDefaultEvent,\n      style: UNSELECTABLE_STYLE\n    }, UNSELECTABLE_ATTRIBUTE, {\n      className: prefixCls + '-selection__clear',\n      onClick: this.onClearSelection\n    }));\n    if (!allowClear) {\n      return null;\n    }\n    if (isCombobox(this.props)) {\n      if (inputValue) {\n        return clear;\n      }\n      return null;\n    }\n    if (inputValue || value.length) {\n      return clear;\n    }\n    return null;\n  };\n\n  Select.prototype.render = function render() {\n    var _rootCls;\n\n    var props = this.props;\n    var multiple = isMultipleOrTags(props);\n    var state = this.state;\n    var className = props.className,\n        disabled = props.disabled,\n        prefixCls = props.prefixCls;\n\n    var ctrlNode = this.renderTopControlNode();\n    var extraSelectionProps = {};\n    var open = this.state.open;\n\n    var options = this._options;\n    if (!isMultipleOrTagsOrCombobox(props)) {\n      extraSelectionProps = {\n        onKeyDown: this.onKeyDown,\n        tabIndex: props.disabled ? -1 : 0\n      };\n    }\n    var rootCls = (_rootCls = {}, _rootCls[className] = !!className, _rootCls[prefixCls] = 1, _rootCls[prefixCls + '-open'] = open, _rootCls[prefixCls + '-focused'] = open || !!this._focused, _rootCls[prefixCls + '-combobox'] = isCombobox(props), _rootCls[prefixCls + '-disabled'] = disabled, _rootCls[prefixCls + '-enabled'] = !disabled, _rootCls[prefixCls + '-allow-clear'] = !!props.allowClear, _rootCls);\n    return React.createElement(\n      SelectTrigger,\n      {\n        onPopupFocus: this.onPopupFocus,\n        onMouseEnter: this.props.onMouseEnter,\n        onMouseLeave: this.props.onMouseLeave,\n        dropdownAlign: props.dropdownAlign,\n        dropdownClassName: props.dropdownClassName,\n        dropdownMatchSelectWidth: props.dropdownMatchSelectWidth,\n        defaultActiveFirstOption: props.defaultActiveFirstOption,\n        dropdownMenuStyle: props.dropdownMenuStyle,\n        transitionName: props.transitionName,\n        animation: props.animation,\n        prefixCls: props.prefixCls,\n        dropdownStyle: props.dropdownStyle,\n        combobox: props.combobox,\n        showSearch: props.showSearch,\n        options: options,\n        multiple: multiple,\n        disabled: disabled,\n        visible: open,\n        inputValue: state.inputValue,\n        value: state.value,\n        backfillValue: state.backfillValue,\n        firstActiveValue: props.firstActiveValue,\n        onDropdownVisibleChange: this.onDropdownVisibleChange,\n        getPopupContainer: props.getPopupContainer,\n        onMenuSelect: this.onMenuSelect,\n        onMenuDeselect: this.onMenuDeselect,\n        onPopupScroll: props.onPopupScroll,\n        showAction: props.showAction,\n        ref: saveRef(this, 'selectTriggerRef')\n      },\n      React.createElement(\n        'div',\n        {\n          style: props.style,\n          ref: saveRef(this, 'rootRef'),\n          onBlur: this.onOuterBlur,\n          onFocus: this.onOuterFocus,\n          className: classnames(rootCls)\n        },\n        React.createElement(\n          'div',\n          _extends({\n            ref: saveRef(this, 'selectionRef'),\n            key: 'selection',\n            className: prefixCls + '-selection\\n            ' + prefixCls + '-selection--' + (multiple ? 'multiple' : 'single'),\n            role: 'combobox',\n            'aria-autocomplete': 'list',\n            'aria-haspopup': 'true',\n            'aria-expanded': open\n          }, extraSelectionProps),\n          ctrlNode,\n          this.renderClear(),\n          multiple || !props.showArrow ? null : React.createElement(\n            'span',\n            _extends({\n              key: 'arrow',\n              className: prefixCls + '-arrow',\n              style: UNSELECTABLE_STYLE\n            }, UNSELECTABLE_ATTRIBUTE, {\n              onClick: this.onArrowClick\n            }),\n            React.createElement('b', null)\n          )\n        )\n      )\n    );\n  };\n\n  return Select;\n}(React.Component);\n\nSelect.propTypes = SelectPropTypes;\nSelect.defaultProps = {\n  prefixCls: 'rc-select',\n  defaultOpen: false,\n  labelInValue: false,\n  defaultActiveFirstOption: true,\n  showSearch: true,\n  allowClear: false,\n  placeholder: '',\n  onChange: noop,\n  onFocus: noop,\n  onBlur: noop,\n  onSelect: noop,\n  onSearch: noop,\n  onDeselect: noop,\n  onInputKeyDown: noop,\n  showArrow: true,\n  dropdownMatchSelectWidth: true,\n  dropdownStyle: {},\n  dropdownMenuStyle: {},\n  optionFilterProp: 'value',\n  optionLabelProp: 'value',\n  notFoundContent: 'Not Found',\n  backfill: false,\n  showAction: ['click'],\n  tokenSeparators: []\n};\n\nvar _initialiseProps = function _initialiseProps() {\n  var _this2 = this;\n\n  this.componentWillReceiveProps = function (nextProps) {\n    var optionsInfo = _this2.getOptionsInfoFromProps(nextProps);\n    _this2.setState({\n      optionsInfo: optionsInfo\n    });\n    if ('value' in nextProps) {\n      var value = _this2.getValueFromProps(nextProps);\n      _this2.setState({\n        value: value\n      }, _this2.forcePopupAlign);\n      if (nextProps.combobox) {\n        _this2.setState({\n          inputValue: value.length ? _this2.getLabelBySingleValue(value[0], optionsInfo) : ''\n        });\n      }\n    }\n  };\n\n  this.onInputChange = function (event) {\n    var tokenSeparators = _this2.props.tokenSeparators;\n\n    var val = event.target.value;\n    if (isMultipleOrTags(_this2.props) && tokenSeparators.length && includesSeparators(val, tokenSeparators)) {\n      var nextValue = _this2.getValueByInput(val);\n      if (nextValue !== undefined) {\n        _this2.fireChange(nextValue);\n      }\n      _this2.setOpenState(false, true);\n      _this2.setInputValue('', false);\n      return;\n    }\n    _this2.setInputValue(val);\n    _this2.setState({\n      open: true\n    });\n    if (isCombobox(_this2.props)) {\n      _this2.fireChange([val]);\n    }\n  };\n\n  this.onDropdownVisibleChange = function (open) {\n    if (open && !_this2._focused) {\n      _this2.clearBlurTime();\n      _this2.timeoutFocus();\n      _this2._focused = true;\n      _this2.updateFocusClassName();\n    }\n    _this2.setOpenState(open);\n  };\n\n  this.onKeyDown = function (event) {\n    var props = _this2.props;\n    if (props.disabled) {\n      return;\n    }\n    var keyCode = event.keyCode;\n    if (_this2.state.open && !_this2.getInputDOMNode()) {\n      _this2.onInputKeyDown(event);\n    } else if (keyCode === KeyCode.ENTER || keyCode === KeyCode.DOWN) {\n      _this2.setOpenState(true);\n      event.preventDefault();\n    }\n  };\n\n  this.onInputKeyDown = function (event) {\n    var props = _this2.props;\n    if (props.disabled) {\n      return;\n    }\n    var state = _this2.state;\n    var keyCode = event.keyCode;\n    if (isMultipleOrTags(props) && !event.target.value && keyCode === KeyCode.BACKSPACE) {\n      event.preventDefault();\n      var value = state.value;\n\n      if (value.length) {\n        _this2.removeSelected(value[value.length - 1]);\n      }\n      return;\n    }\n    if (keyCode === KeyCode.DOWN) {\n      if (!state.open) {\n        _this2.openIfHasChildren();\n        event.preventDefault();\n        event.stopPropagation();\n        return;\n      }\n    } else if (keyCode === KeyCode.ESC) {\n      if (state.open) {\n        _this2.setOpenState(false);\n        event.preventDefault();\n        event.stopPropagation();\n      }\n      return;\n    }\n\n    if (state.open) {\n      var menu = _this2.selectTriggerRef.getInnerMenu();\n      if (menu && menu.onKeyDown(event, _this2.handleBackfill)) {\n        event.preventDefault();\n        event.stopPropagation();\n      }\n    }\n  };\n\n  this.onMenuSelect = function (_ref) {\n    var item = _ref.item;\n\n    var value = _this2.state.value;\n    var props = _this2.props;\n    var selectedValue = getValuePropValue(item);\n    var lastValue = value[value.length - 1];\n    _this2.fireSelect(selectedValue);\n    if (isMultipleOrTags(props)) {\n      if (findIndexInValueBySingleValue(value, selectedValue) !== -1) {\n        return;\n      }\n      value = value.concat([selectedValue]);\n    } else {\n      if (isCombobox(props)) {\n        _this2.skipAdjustOpen = true;\n        _this2.clearAdjustTimer();\n        _this2.skipAdjustOpenTimer = setTimeout(function () {\n          _this2.skipAdjustOpen = false;\n        }, 0);\n      }\n      if (lastValue && lastValue === selectedValue && selectedValue !== _this2.state.backfillValue) {\n        _this2.setOpenState(false, true);\n        return;\n      }\n      value = [selectedValue];\n      _this2.setOpenState(false, true);\n    }\n    _this2.fireChange(value);\n    var inputValue = void 0;\n    if (isCombobox(props)) {\n      inputValue = getPropValue(item, props.optionLabelProp);\n    } else {\n      inputValue = '';\n    }\n    _this2.setInputValue(inputValue, false);\n  };\n\n  this.onMenuDeselect = function (_ref2) {\n    var item = _ref2.item,\n        domEvent = _ref2.domEvent;\n\n    if (domEvent.type === 'click') {\n      _this2.removeSelected(getValuePropValue(item));\n    }\n    _this2.setInputValue('', false);\n  };\n\n  this.onArrowClick = function (e) {\n    e.stopPropagation();\n    e.preventDefault();\n    if (!_this2.props.disabled) {\n      _this2.setOpenState(!_this2.state.open, !_this2.state.open);\n    }\n  };\n\n  this.onPlaceholderClick = function () {\n    if (_this2.getInputDOMNode()) {\n      _this2.getInputDOMNode().focus();\n    }\n  };\n\n  this.onOuterFocus = function (e) {\n    if (_this2.props.disabled) {\n      e.preventDefault();\n      return;\n    }\n    _this2.clearBlurTime();\n    if (!isMultipleOrTagsOrCombobox(_this2.props) && e.target === _this2.getInputDOMNode()) {\n      return;\n    }\n    if (_this2._focused) {\n      return;\n    }\n    _this2._focused = true;\n    _this2.updateFocusClassName();\n    _this2.timeoutFocus();\n  };\n\n  this.onPopupFocus = function () {\n    // fix ie scrollbar, focus element again\n    _this2.maybeFocus(true, true);\n  };\n\n  this.onOuterBlur = function (e) {\n    if (_this2.props.disabled) {\n      e.preventDefault();\n      return;\n    }\n    _this2.blurTimer = setTimeout(function () {\n      _this2._focused = false;\n      _this2.updateFocusClassName();\n      var props = _this2.props;\n      var value = _this2.state.value;\n      var inputValue = _this2.state.inputValue;\n\n      if (isSingleMode(props) && props.showSearch && inputValue && props.defaultActiveFirstOption) {\n        var options = _this2._options || [];\n        if (options.length) {\n          var firstOption = findFirstMenuItem(options);\n          if (firstOption) {\n            value = [getValuePropValue(firstOption)];\n            _this2.fireChange(value);\n          }\n        }\n      } else if (isMultipleOrTags(props) && inputValue) {\n        // why not use setState?\n        _this2.state.inputValue = _this2.getInputDOMNode().value = '';\n\n        value = _this2.getValueByInput(inputValue);\n        if (value !== undefined) {\n          _this2.fireChange(value);\n        }\n      }\n      props.onBlur(_this2.getVLForOnChange(value));\n      _this2.setOpenState(false);\n    }, 10);\n  };\n\n  this.onClearSelection = function (event) {\n    var props = _this2.props;\n    var state = _this2.state;\n    if (props.disabled) {\n      return;\n    }\n    var inputValue = state.inputValue,\n        value = state.value;\n\n    event.stopPropagation();\n    if (inputValue || value.length) {\n      if (value.length) {\n        _this2.fireChange([]);\n      }\n      _this2.setOpenState(false, true);\n      if (inputValue) {\n        _this2.setInputValue('');\n      }\n    }\n  };\n\n  this.onChoiceAnimationLeave = function () {\n    _this2.forcePopupAlign();\n  };\n\n  this.getValueFromProps = function (props) {\n    var value = [];\n    if ('value' in props) {\n      value = toArray(props.value);\n    } else {\n      value = toArray(props.defaultValue);\n    }\n    if (props.labelInValue) {\n      value = value.map(function (v) {\n        return v.key;\n      });\n    }\n    return value;\n  };\n\n  this.getOptionsInfoFromProps = function (props) {\n    var options = _this2.getOptionsFromChildren(props.children);\n    var oldOptionsInfo = _this2.state ? _this2.state.optionsInfo : {};\n    var value = _this2.state ? _this2.state.value : [];\n    var optionsInfo = {};\n    options.forEach(function (option) {\n      var singleValue = getValuePropValue(option);\n      optionsInfo[getMapKey(singleValue)] = {\n        option: option,\n        value: singleValue,\n        label: _this2.getLabelFromOption(option),\n        title: option.props.title\n      };\n    });\n    value.forEach(function (v) {\n      var key = getMapKey(v);\n      if (!optionsInfo[key]) {\n        optionsInfo[key] = oldOptionsInfo[key];\n      }\n    });\n    return optionsInfo;\n  };\n\n  this.getOptionInfoBySingleValue = function (value, optionsInfo) {\n    var info = void 0;\n    optionsInfo = optionsInfo || _this2.state.optionsInfo;\n    if (optionsInfo[getMapKey(value)]) {\n      info = optionsInfo[getMapKey(value)];\n    }\n    if (info) {\n      return info;\n    }\n    var defaultLabel = value;\n    if (_this2.props.labelInValue) {\n      var label = getLabelFromPropsValue(_this2.props.value, value);\n      if (label !== undefined) {\n        defaultLabel = label;\n      }\n    }\n    var defaultInfo = {\n      option: React.createElement(\n        Option,\n        { value: value, key: value },\n        value\n      ),\n      value: value,\n      label: defaultLabel\n    };\n    return defaultInfo;\n  };\n\n  this.getOptionBySingleValue = function (value) {\n    var _getOptionInfoBySingl = _this2.getOptionInfoBySingleValue(value),\n        option = _getOptionInfoBySingl.option;\n\n    return option;\n  };\n\n  this.getOptionsBySingleValue = function (values) {\n    return values.map(function (value) {\n      return _this2.getOptionBySingleValue(value);\n    });\n  };\n\n  this.getOptionsFromChildren = function (children) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n\n    React.Children.forEach(children, function (child) {\n      if (!child) {\n        return;\n      }\n      if (child.type.isSelectOptGroup) {\n        _this2.getOptionsFromChildren(child.props.children, options);\n      } else {\n        options.push(child);\n      }\n    });\n    return options;\n  };\n\n  this.getValueByLabel = function (label) {\n    if (label === undefined) {\n      return null;\n    }\n    var value = null;\n    Object.keys(_this2.state.optionsInfo).forEach(function (key) {\n      var info = _this2.state.optionsInfo[key];\n      if (toArray(info.label).join('') === label) {\n        value = info.value;\n      }\n    });\n    return value;\n  };\n\n  this.getLabelFromOption = function (option) {\n    return getPropValue(option, _this2.props.optionLabelProp);\n  };\n\n  this.getVLBySingleValue = function (value) {\n    if (_this2.props.labelInValue) {\n      return {\n        key: value,\n        label: _this2.getLabelBySingleValue(value)\n      };\n    }\n    return value;\n  };\n\n  this.getVLForOnChange = function (vls_) {\n    var vls = vls_;\n    if (vls !== undefined) {\n      if (!_this2.props.labelInValue) {\n        vls = vls.map(function (v) {\n          return v;\n        });\n      } else {\n        vls = vls.map(function (vl) {\n          return {\n            key: vl,\n            label: _this2.getLabelBySingleValue(vl)\n          };\n        });\n      }\n      return isMultipleOrTags(_this2.props) ? vls : vls[0];\n    }\n    return vls;\n  };\n\n  this.getLabelBySingleValue = function (value, optionsInfo) {\n    var _getOptionInfoBySingl2 = _this2.getOptionInfoBySingleValue(value, optionsInfo),\n        label = _getOptionInfoBySingl2.label;\n\n    return label;\n  };\n\n  this.getDropdownContainer = function () {\n    if (!_this2.dropdownContainer) {\n      _this2.dropdownContainer = document.createElement('div');\n      document.body.appendChild(_this2.dropdownContainer);\n    }\n    return _this2.dropdownContainer;\n  };\n\n  this.getPlaceholderElement = function () {\n    var props = _this2.props,\n        state = _this2.state;\n\n    var hidden = false;\n    if (state.inputValue) {\n      hidden = true;\n    }\n    if (state.value.length) {\n      hidden = true;\n    }\n    if (isCombobox(props) && state.value.length === 1 && !state.value[0]) {\n      hidden = false;\n    }\n    var placeholder = props.placeholder;\n    if (placeholder) {\n      return React.createElement(\n        'div',\n        _extends({\n          onMouseDown: preventDefaultEvent,\n          style: _extends({\n            display: hidden ? 'none' : 'block'\n          }, UNSELECTABLE_STYLE)\n        }, UNSELECTABLE_ATTRIBUTE, {\n          onClick: _this2.onPlaceholderClick,\n          className: props.prefixCls + '-selection__placeholder'\n        }),\n        placeholder\n      );\n    }\n    return null;\n  };\n\n  this.getInputElement = function () {\n    var _classnames;\n\n    var props = _this2.props;\n    var inputElement = props.getInputElement ? props.getInputElement() : React.createElement('input', { id: props.id, autoComplete: 'off' });\n    var inputCls = classnames(inputElement.props.className, (_classnames = {}, _classnames[props.prefixCls + '-search__field'] = true, _classnames));\n    // https://github.com/ant-design/ant-design/issues/4992#issuecomment-281542159\n    // Add space to the end of the inputValue as the width measurement tolerance\n    return React.createElement(\n      'div',\n      { className: props.prefixCls + '-search__field__wrap' },\n      React.cloneElement(inputElement, {\n        ref: saveRef(_this2, 'inputRef'),\n        onChange: _this2.onInputChange,\n        onKeyDown: chaining(_this2.onInputKeyDown, inputElement.props.onKeyDown, _this2.props.onInputKeyDown),\n        value: _this2.state.inputValue,\n        disabled: props.disabled,\n        className: inputCls\n      }),\n      React.createElement(\n        'span',\n        {\n          ref: saveRef(_this2, 'inputMirrorRef'),\n          className: props.prefixCls + '-search__field__mirror'\n        },\n        _this2.state.inputValue,\n        '\\xA0'\n      )\n    );\n  };\n\n  this.getInputDOMNode = function () {\n    return _this2.topCtrlRef ? _this2.topCtrlRef.querySelector('input,textarea,div[contentEditable]') : _this2.inputRef;\n  };\n\n  this.getInputMirrorDOMNode = function () {\n    return _this2.inputMirrorRef;\n  };\n\n  this.getPopupDOMNode = function () {\n    return _this2.selectTriggerRef.getPopupDOMNode();\n  };\n\n  this.getPopupMenuComponent = function () {\n    return _this2.selectTriggerRef.getInnerMenu();\n  };\n\n  this.setOpenState = function (open, needFocus) {\n    var props = _this2.props,\n        state = _this2.state;\n\n    if (state.open === open) {\n      _this2.maybeFocus(open, needFocus);\n      return;\n    }\n    var nextState = {\n      open: open,\n      backfillValue: undefined\n    };\n    // clear search input value when open is false in singleMode.\n    if (!open && isSingleMode(props) && props.showSearch) {\n      _this2.setInputValue('');\n    }\n    if (!open) {\n      _this2.maybeFocus(open, needFocus);\n    }\n    _this2.setState(nextState, function () {\n      if (open) {\n        _this2.maybeFocus(open, needFocus);\n      }\n    });\n  };\n\n  this.setInputValue = function (inputValue) {\n    var fireSearch = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;\n\n    if (inputValue !== _this2.state.inputValue) {\n      _this2.setState({\n        inputValue: inputValue\n      }, _this2.forcePopupAlign);\n      if (fireSearch) {\n        _this2.props.onSearch(inputValue);\n      }\n    }\n  };\n\n  this.getValueByInput = function (string) {\n    var _props2 = _this2.props,\n        multiple = _props2.multiple,\n        tokenSeparators = _props2.tokenSeparators;\n\n    var nextValue = _this2.state.value;\n    var hasNewValue = false;\n    splitBySeparators(string, tokenSeparators).forEach(function (label) {\n      var selectedValue = [label];\n      if (multiple) {\n        var value = _this2.getValueByLabel(label);\n        if (value && findIndexInValueBySingleValue(nextValue, value) === -1) {\n          nextValue = nextValue.concat(value);\n          hasNewValue = true;\n          _this2.fireSelect(value);\n        }\n      } else {\n        // tag\n        if (findIndexInValueBySingleValue(nextValue, label) === -1) {\n          nextValue = nextValue.concat(selectedValue);\n          hasNewValue = true;\n          _this2.fireSelect(label);\n        }\n      }\n    });\n    return hasNewValue ? nextValue : undefined;\n  };\n\n  this.handleBackfill = function (item) {\n    if (!_this2.props.backfill || !(isSingleMode(_this2.props) || isCombobox(_this2.props))) {\n      return;\n    }\n\n    var key = getValuePropValue(item);\n\n    if (isCombobox(_this2.props)) {\n      _this2.setInputValue(key, false);\n    }\n\n    _this2.setState({\n      value: [key],\n      backfillValue: key\n    });\n  };\n\n  this.filterOption = function (input, child) {\n    var defaultFilter = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : defaultFilterFn;\n    var value = _this2.state.value;\n\n    var lastValue = value[value.length - 1];\n    if (!input || lastValue && lastValue === _this2.state.backfillValue) {\n      return true;\n    }\n    var filterFn = _this2.props.filterOption;\n    if ('filterOption' in _this2.props) {\n      if (_this2.props.filterOption === true) {\n        filterFn = defaultFilter;\n      }\n    } else {\n      filterFn = defaultFilter;\n    }\n\n    if (!filterFn) {\n      return true;\n    } else if (typeof filterFn === 'function') {\n      return filterFn.call(_this2, input, child);\n    } else if (child.props.disabled) {\n      return false;\n    }\n    return true;\n  };\n\n  this.timeoutFocus = function () {\n    if (_this2.focusTimer) {\n      _this2.clearFocusTime();\n    }\n    _this2.focusTimer = setTimeout(function () {\n      _this2.props.onFocus();\n    }, 10);\n  };\n\n  this.clearFocusTime = function () {\n    if (_this2.focusTimer) {\n      clearTimeout(_this2.focusTimer);\n      _this2.focusTimer = null;\n    }\n  };\n\n  this.clearBlurTime = function () {\n    if (_this2.blurTimer) {\n      clearTimeout(_this2.blurTimer);\n      _this2.blurTimer = null;\n    }\n  };\n\n  this.clearAdjustTimer = function () {\n    if (_this2.skipAdjustOpenTimer) {\n      clearTimeout(_this2.skipAdjustOpenTimer);\n      _this2.skipAdjustOpenTimer = null;\n    }\n  };\n\n  this.updateFocusClassName = function () {\n    var rootRef = _this2.rootRef,\n        props = _this2.props;\n    // avoid setState and its side effect\n\n    if (_this2._focused) {\n      classes(rootRef).add(props.prefixCls + '-focused');\n    } else {\n      classes(rootRef).remove(props.prefixCls + '-focused');\n    }\n  };\n\n  this.maybeFocus = function (open, needFocus) {\n    if (needFocus || open) {\n      var input = _this2.getInputDOMNode();\n      var _document = document,\n          activeElement = _document.activeElement;\n\n      if (input && (open || isMultipleOrTagsOrCombobox(_this2.props))) {\n        if (activeElement !== input) {\n          input.focus();\n          _this2._focused = true;\n        }\n      } else {\n        if (activeElement !== _this2.selectionRef) {\n          _this2.selectionRef.focus();\n          _this2._focused = true;\n        }\n      }\n    }\n  };\n\n  this.removeSelected = function (selectedKey) {\n    var props = _this2.props;\n    if (props.disabled || _this2.isChildDisabled(selectedKey)) {\n      return;\n    }\n    var value = _this2.state.value.filter(function (singleValue) {\n      return singleValue !== selectedKey;\n    });\n    var canMultiple = isMultipleOrTags(props);\n\n    if (canMultiple) {\n      var event = selectedKey;\n      if (props.labelInValue) {\n        event = {\n          key: selectedKey,\n          label: _this2.getLabelBySingleValue(selectedKey)\n        };\n      }\n      props.onDeselect(event, _this2.getOptionBySingleValue(selectedKey));\n    }\n    _this2.fireChange(value);\n  };\n\n  this.openIfHasChildren = function () {\n    var props = _this2.props;\n    if (React.Children.count(props.children) || isSingleMode(props)) {\n      _this2.setOpenState(true);\n    }\n  };\n\n  this.fireSelect = function (value) {\n    _this2.props.onSelect(_this2.getVLBySingleValue(value), _this2.getOptionBySingleValue(value));\n  };\n\n  this.fireChange = function (value) {\n    var props = _this2.props;\n    if (!('value' in props)) {\n      _this2.setState({\n        value: value\n      }, _this2.forcePopupAlign);\n    }\n    var vls = _this2.getVLForOnChange(value);\n    var options = _this2.getOptionsBySingleValue(value);\n    props.onChange(vls, isMultipleOrTags(_this2.props) ? options : options[0]);\n  };\n\n  this.isChildDisabled = function (key) {\n    return childrenToArray(_this2.props.children).some(function (child) {\n      var childValue = getValuePropValue(child);\n      return childValue === key && child.props && child.props.disabled;\n    });\n  };\n\n  this.adjustOpenState = function () {\n    if (_this2.skipAdjustOpen) {\n      return;\n    }\n    var open = _this2.state.open;\n\n    var options = [];\n    // If hidden menu due to no options, then it should be calculated again\n    if (open || _this2.hiddenForNoOptions) {\n      options = _this2.renderFilterOptions();\n    }\n    _this2._options = options;\n\n    if (isMultipleOrTagsOrCombobox(_this2.props) || !_this2.props.showSearch) {\n      if (open && !options.length) {\n        open = false;\n        _this2.hiddenForNoOptions = true;\n      }\n      // Keep menu open if there are options and hidden for no options before\n      if (_this2.hiddenForNoOptions && options.length) {\n        open = true;\n        _this2.hiddenForNoOptions = false;\n      }\n    }\n    _this2.state.open = open;\n  };\n\n  this.forcePopupAlign = function () {\n    _this2.selectTriggerRef.triggerRef.forcePopupAlign();\n  };\n\n  this.renderFilterOptions = function () {\n    var inputValue = _this2.state.inputValue;\n    var _props3 = _this2.props,\n        children = _props3.children,\n        tags = _props3.tags,\n        filterOption = _props3.filterOption,\n        notFoundContent = _props3.notFoundContent;\n\n    var menuItems = [];\n    var childrenKeys = [];\n    var options = _this2.renderFilterOptionsFromChildren(children, childrenKeys, menuItems);\n    if (tags) {\n      // tags value must be string\n      var value = _this2.state.value || [];\n      value = value.filter(function (singleValue) {\n        return childrenKeys.indexOf(singleValue) === -1 && (!inputValue || String(singleValue).indexOf(String(inputValue)) > -1);\n      });\n      value.forEach(function (singleValue) {\n        var key = singleValue;\n        var menuItem = React.createElement(\n          MenuItem,\n          {\n            style: UNSELECTABLE_STYLE,\n            attribute: UNSELECTABLE_ATTRIBUTE,\n            value: key,\n            key: key\n          },\n          key\n        );\n        options.push(menuItem);\n        menuItems.push(menuItem);\n      });\n      if (inputValue) {\n        var notFindInputItem = menuItems.every(function (option) {\n          // this.filterOption return true has two meaning,\n          // 1, some one exists after filtering\n          // 2, filterOption is set to false\n          // condition 2 does not mean the option has same value with inputValue\n          var filterFn = function filterFn() {\n            return getValuePropValue(option) === inputValue;\n          };\n          if (filterOption !== false) {\n            return !_this2.filterOption.call(_this2, inputValue, option, filterFn);\n          }\n          return !filterFn();\n        });\n        if (notFindInputItem) {\n          options.unshift(React.createElement(\n            MenuItem,\n            {\n              style: UNSELECTABLE_STYLE,\n              attribute: UNSELECTABLE_ATTRIBUTE,\n              value: inputValue,\n              key: inputValue\n            },\n            inputValue\n          ));\n        }\n      }\n    }\n\n    if (!options.length && notFoundContent) {\n      options = [React.createElement(\n        MenuItem,\n        {\n          style: UNSELECTABLE_STYLE,\n          attribute: UNSELECTABLE_ATTRIBUTE,\n          disabled: true,\n          value: 'NOT_FOUND',\n          key: 'NOT_FOUND'\n        },\n        notFoundContent\n      )];\n    }\n    return options;\n  };\n\n  this.renderFilterOptionsFromChildren = function (children, childrenKeys, menuItems) {\n    var sel = [];\n    var props = _this2.props;\n    var inputValue = _this2.state.inputValue;\n\n    var tags = props.tags;\n    React.Children.forEach(children, function (child) {\n      if (!child) {\n        return;\n      }\n      if (child.type.isSelectOptGroup) {\n        var innerItems = _this2.renderFilterOptionsFromChildren(child.props.children, childrenKeys, menuItems);\n        if (innerItems.length) {\n          var label = child.props.label;\n          var key = child.key;\n          if (!key && typeof label === 'string') {\n            key = label;\n          } else if (!label && key) {\n            label = key;\n          }\n          sel.push(React.createElement(\n            MenuItemGroup,\n            { key: key, title: label },\n            innerItems\n          ));\n        }\n        return;\n      }\n\n      warning(child.type.isSelectOption, 'the children of `Select` should be `Select.Option` or `Select.OptGroup`, ' + ('instead of `' + (child.type.name || child.type.displayName || child.type) + '`.'));\n\n      var childValue = getValuePropValue(child);\n\n      validateOptionValue(childValue, _this2.props);\n\n      if (_this2.filterOption(inputValue, child)) {\n        var menuItem = React.createElement(MenuItem, _extends({\n          style: UNSELECTABLE_STYLE,\n          attribute: UNSELECTABLE_ATTRIBUTE,\n          value: childValue,\n          key: childValue\n        }, child.props));\n        sel.push(menuItem);\n        menuItems.push(menuItem);\n      }\n      if (tags && !child.props.disabled) {\n        childrenKeys.push(childValue);\n      }\n    });\n\n    return sel;\n  };\n\n  this.renderTopControlNode = function () {\n    var _state2 = _this2.state,\n        value = _state2.value,\n        open = _state2.open,\n        inputValue = _state2.inputValue;\n\n    var props = _this2.props;\n    var choiceTransitionName = props.choiceTransitionName,\n        prefixCls = props.prefixCls,\n        maxTagTextLength = props.maxTagTextLength,\n        maxTagCount = props.maxTagCount,\n        maxTagPlaceholder = props.maxTagPlaceholder,\n        showSearch = props.showSearch;\n\n    var className = prefixCls + '-selection__rendered';\n    // search input is inside topControlNode in single, multiple & combobox. 2016/04/13\n    var innerNode = null;\n    if (isSingleMode(props)) {\n      var selectedValue = null;\n      if (value.length) {\n        var showSelectedValue = false;\n        var opacity = 1;\n        if (!showSearch) {\n          showSelectedValue = true;\n        } else {\n          if (open) {\n            showSelectedValue = !inputValue;\n            if (showSelectedValue) {\n              opacity = 0.4;\n            }\n          } else {\n            showSelectedValue = true;\n          }\n        }\n        var singleValue = value[0];\n\n        var _getOptionInfoBySingl3 = _this2.getOptionInfoBySingleValue(singleValue),\n            label = _getOptionInfoBySingl3.label,\n            title = _getOptionInfoBySingl3.title;\n\n        selectedValue = React.createElement(\n          'div',\n          {\n            key: 'value',\n            className: prefixCls + '-selection-selected-value',\n            title: title || label,\n            style: {\n              display: showSelectedValue ? 'block' : 'none',\n              opacity: opacity\n            }\n          },\n          label\n        );\n      }\n      if (!showSearch) {\n        innerNode = [selectedValue];\n      } else {\n        innerNode = [selectedValue, React.createElement(\n          'div',\n          {\n            className: prefixCls + '-search ' + prefixCls + '-search--inline',\n            key: 'input',\n            style: {\n              display: open ? 'block' : 'none'\n            }\n          },\n          _this2.getInputElement()\n        )];\n      }\n    } else {\n      var selectedValueNodes = [];\n      var limitedCountValue = value;\n      var maxTagPlaceholderEl = void 0;\n      if (maxTagCount !== undefined && value.length > maxTagCount) {\n        limitedCountValue = limitedCountValue.slice(0, maxTagCount);\n        var omittedValues = _this2.getVLForOnChange(value.slice(maxTagCount, value.length));\n        var content = '+ ' + (value.length - maxTagCount) + ' ...';\n        if (maxTagPlaceholder) {\n          content = typeof maxTagPlaceholder === 'function' ? maxTagPlaceholder(omittedValues) : maxTagPlaceholder;\n        }\n        maxTagPlaceholderEl = React.createElement(\n          'li',\n          _extends({\n            style: UNSELECTABLE_STYLE\n          }, UNSELECTABLE_ATTRIBUTE, {\n            onMouseDown: preventDefaultEvent,\n            className: prefixCls + '-selection__choice ' + prefixCls + '-selection__choice__disabled',\n            key: 'maxTagPlaceholder',\n            title: content\n          }),\n          React.createElement(\n            'div',\n            { className: prefixCls + '-selection__choice__content' },\n            content\n          )\n        );\n      }\n      if (isMultipleOrTags(props)) {\n        selectedValueNodes = limitedCountValue.map(function (singleValue) {\n          var info = _this2.getOptionInfoBySingleValue(singleValue);\n          var content = info.label;\n          var title = info.title || content;\n          if (maxTagTextLength && typeof content === 'string' && content.length > maxTagTextLength) {\n            content = content.slice(0, maxTagTextLength) + '...';\n          }\n          var disabled = _this2.isChildDisabled(singleValue);\n          var choiceClassName = disabled ? prefixCls + '-selection__choice ' + prefixCls + '-selection__choice__disabled' : prefixCls + '-selection__choice';\n          return React.createElement(\n            'li',\n            _extends({\n              style: UNSELECTABLE_STYLE\n            }, UNSELECTABLE_ATTRIBUTE, {\n              onMouseDown: preventDefaultEvent,\n              className: choiceClassName,\n              key: singleValue,\n              title: title\n            }),\n            React.createElement(\n              'div',\n              { className: prefixCls + '-selection__choice__content' },\n              content\n            ),\n            disabled ? null : React.createElement('span', {\n              className: prefixCls + '-selection__choice__remove',\n              onClick: _this2.removeSelected.bind(_this2, singleValue)\n            })\n          );\n        });\n      }\n      if (maxTagPlaceholderEl) {\n        selectedValueNodes.push(maxTagPlaceholderEl);\n      }\n      selectedValueNodes.push(React.createElement(\n        'li',\n        {\n          className: prefixCls + '-search ' + prefixCls + '-search--inline',\n          key: '__input'\n        },\n        _this2.getInputElement()\n      ));\n\n      if (isMultipleOrTags(props) && choiceTransitionName) {\n        innerNode = React.createElement(\n          Animate,\n          {\n            onLeave: _this2.onChoiceAnimationLeave,\n            component: 'ul',\n            transitionName: choiceTransitionName\n          },\n          selectedValueNodes\n        );\n      } else {\n        innerNode = React.createElement(\n          'ul',\n          null,\n          selectedValueNodes\n        );\n      }\n    }\n    return React.createElement(\n      'div',\n      { className: className, ref: saveRef(_this2, 'topCtrlRef') },\n      _this2.getPlaceholderElement(),\n      innerNode\n    );\n  };\n};\n\nexport default Select;\n\n\nSelect.displayName = 'Select';"]},"metadata":{},"sourceType":"module"}