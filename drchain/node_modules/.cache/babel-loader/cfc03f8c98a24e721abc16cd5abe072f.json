{"ast":null,"code":"import _extends from 'babel-runtime/helpers/extends';\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport KeyCode from 'rc-util/es/KeyCode';\nimport createChainedFunction from 'rc-util/es/createChainedFunction';\nimport classNames from 'classnames';\nimport { getKeyFromChildrenIndex, loopMenuItem } from './util';\nimport DOMWrap from './DOMWrap';\n\nfunction allDisabled(arr) {\n  if (!arr.length) {\n    return true;\n  }\n\n  return arr.every(function (c) {\n    return !!c.props.disabled;\n  });\n}\n\nfunction updateActiveKey(store, menuId, activeKey) {\n  var _extends2;\n\n  var state = store.getState();\n  store.setState({\n    activeKey: _extends({}, state.activeKey, (_extends2 = {}, _extends2[menuId] = activeKey, _extends2))\n  });\n}\n\nexport function getActiveKey(props, originalActiveKey) {\n  var activeKey = originalActiveKey;\n  var children = props.children,\n      eventKey = props.eventKey;\n\n  if (activeKey) {\n    var found = void 0;\n    loopMenuItem(children, function (c, i) {\n      if (c && !c.props.disabled && activeKey === getKeyFromChildrenIndex(c, eventKey, i)) {\n        found = true;\n      }\n    });\n\n    if (found) {\n      return activeKey;\n    }\n  }\n\n  activeKey = null;\n\n  if (props.defaultActiveFirst) {\n    loopMenuItem(children, function (c, i) {\n      if (!activeKey && c && !c.props.disabled) {\n        activeKey = getKeyFromChildrenIndex(c, eventKey, i);\n      }\n    });\n    return activeKey;\n  }\n\n  return activeKey;\n}\n\nfunction saveRef(index, subIndex, c) {\n  if (c) {\n    if (subIndex !== undefined) {\n      this.instanceArray[index] = this.instanceArray[index] || [];\n      this.instanceArray[index][subIndex] = c;\n    } else {\n      this.instanceArray[index] = c;\n    }\n  }\n}\n\nvar MenuMixin = {\n  propTypes: {\n    focusable: PropTypes.bool,\n    multiple: PropTypes.bool,\n    style: PropTypes.object,\n    defaultActiveFirst: PropTypes.bool,\n    visible: PropTypes.bool,\n    activeKey: PropTypes.string,\n    selectedKeys: PropTypes.arrayOf(PropTypes.string),\n    defaultSelectedKeys: PropTypes.arrayOf(PropTypes.string),\n    defaultOpenKeys: PropTypes.arrayOf(PropTypes.string),\n    openKeys: PropTypes.arrayOf(PropTypes.string),\n    children: PropTypes.any\n  },\n  getDefaultProps: function getDefaultProps() {\n    return {\n      prefixCls: 'rc-menu',\n      className: '',\n      mode: 'vertical',\n      level: 1,\n      inlineIndent: 24,\n      visible: true,\n      focusable: true,\n      style: {}\n    };\n  },\n  componentWillReceiveProps: function componentWillReceiveProps(nextProps) {\n    var originalActiveKey = 'activeKey' in nextProps ? nextProps.activeKey : this.getStore().getState().activeKey[this.getEventKey()];\n    var activeKey = getActiveKey(nextProps, originalActiveKey);\n\n    if (activeKey !== originalActiveKey) {\n      updateActiveKey(this.getStore(), this.getEventKey(), activeKey);\n    }\n  },\n  shouldComponentUpdate: function shouldComponentUpdate(nextProps) {\n    return this.props.visible || nextProps.visible;\n  },\n  componentWillMount: function componentWillMount() {\n    this.instanceArray = [];\n  },\n  // all keyboard events callbacks run from here at first\n  onKeyDown: function onKeyDown(e, callback) {\n    var keyCode = e.keyCode;\n    var handled = void 0;\n    this.getFlatInstanceArray().forEach(function (obj) {\n      if (obj && obj.props.active && obj.onKeyDown) {\n        handled = obj.onKeyDown(e);\n      }\n    });\n\n    if (handled) {\n      return 1;\n    }\n\n    var activeItem = null;\n\n    if (keyCode === KeyCode.UP || keyCode === KeyCode.DOWN) {\n      activeItem = this.step(keyCode === KeyCode.UP ? -1 : 1);\n    }\n\n    if (activeItem) {\n      e.preventDefault();\n      updateActiveKey(this.getStore(), this.getEventKey(), activeItem.props.eventKey);\n\n      if (typeof callback === 'function') {\n        callback(activeItem);\n      }\n\n      return 1;\n    } else if (activeItem === undefined) {\n      e.preventDefault();\n      updateActiveKey(this.getStore(), this.getEventKey(), null);\n      return 1;\n    }\n  },\n  onItemHover: function onItemHover(e) {\n    var key = e.key,\n        hover = e.hover;\n    updateActiveKey(this.getStore(), this.getEventKey(), hover ? key : null);\n  },\n  getEventKey: function getEventKey() {\n    // when eventKey not available ,it's menu and return menu id '0-menu-'\n    return this.props.eventKey || '0-menu-';\n  },\n  getStore: function getStore() {\n    var store = this.store || this.props.store;\n    return store;\n  },\n  getFlatInstanceArray: function getFlatInstanceArray() {\n    var instanceArray = this.instanceArray;\n    var hasInnerArray = instanceArray.some(function (a) {\n      return Array.isArray(a);\n    });\n\n    if (hasInnerArray) {\n      instanceArray = [];\n      this.instanceArray.forEach(function (a) {\n        if (Array.isArray(a)) {\n          instanceArray.push.apply(instanceArray, a);\n        } else {\n          instanceArray.push(a);\n        }\n      });\n      this.instanceArray = instanceArray;\n    }\n\n    return instanceArray;\n  },\n  renderCommonMenuItem: function renderCommonMenuItem(child, i, subIndex, extraProps) {\n    var state = this.getStore().getState();\n    var props = this.props;\n    var key = getKeyFromChildrenIndex(child, props.eventKey, i);\n    var childProps = child.props;\n    var isActive = key === state.activeKey;\n\n    var newChildProps = _extends({\n      mode: props.mode,\n      level: props.level,\n      inlineIndent: props.inlineIndent,\n      renderMenuItem: this.renderMenuItem,\n      rootPrefixCls: props.prefixCls,\n      index: i,\n      parentMenu: this,\n      // customized ref function, need to be invoked manually in child's componentDidMount\n      manualRef: childProps.disabled ? undefined : createChainedFunction(child.ref, saveRef.bind(this, i, subIndex)),\n      eventKey: key,\n      active: !childProps.disabled && isActive,\n      multiple: props.multiple,\n      onClick: this.onClick,\n      onItemHover: this.onItemHover,\n      openTransitionName: this.getOpenTransitionName(),\n      openAnimation: props.openAnimation,\n      subMenuOpenDelay: props.subMenuOpenDelay,\n      subMenuCloseDelay: props.subMenuCloseDelay,\n      forceSubMenuRender: props.forceSubMenuRender,\n      onOpenChange: this.onOpenChange,\n      onDeselect: this.onDeselect,\n      onSelect: this.onSelect\n    }, extraProps);\n\n    if (props.mode === 'inline') {\n      newChildProps.triggerSubMenuAction = 'click';\n    }\n\n    return React.cloneElement(child, newChildProps);\n  },\n  renderRoot: function renderRoot(props) {\n    var _this = this;\n\n    this.instanceArray = [];\n    var className = classNames(props.prefixCls, props.className, props.prefixCls + '-' + props.mode);\n    var domProps = {\n      className: className,\n      role: 'menu',\n      'aria-activedescendant': ''\n    };\n\n    if (props.id) {\n      domProps.id = props.id;\n    }\n\n    if (props.focusable) {\n      domProps.tabIndex = '0';\n      domProps.onKeyDown = this.onKeyDown;\n    }\n\n    return (// ESLint is not smart enough to know that the type of `children` was checked.\n\n      /* eslint-disable */\n      React.createElement(DOMWrap, _extends({\n        style: props.style,\n        tag: 'ul',\n        hiddenClassName: props.prefixCls + '-hidden',\n        visible: props.visible\n      }, domProps), React.Children.map(props.children, function (c, i, subIndex) {\n        return _this.renderMenuItem(c, i, subIndex, props.eventKey || '0-menu-');\n      }))\n      /*eslint-enable */\n\n    );\n  },\n  step: function step(direction) {\n    var children = this.getFlatInstanceArray();\n    var activeKey = this.getStore().getState().activeKey[this.getEventKey()];\n    var len = children.length;\n\n    if (!len) {\n      return null;\n    }\n\n    if (direction < 0) {\n      children = children.concat().reverse();\n    } // find current activeIndex\n\n\n    var activeIndex = -1;\n    children.every(function (c, ci) {\n      if (c && c.props.eventKey === activeKey) {\n        activeIndex = ci;\n        return false;\n      }\n\n      return true;\n    });\n\n    if (!this.props.defaultActiveFirst && activeIndex !== -1) {\n      if (allDisabled(children.slice(activeIndex, len - 1))) {\n        return undefined;\n      }\n    }\n\n    var start = (activeIndex + 1) % len;\n    var i = start;\n\n    for (;;) {\n      var child = children[i];\n\n      if (!child || child.props.disabled) {\n        i = (i + 1 + len) % len; // complete a loop\n\n        if (i === start) {\n          return null;\n        }\n      } else {\n        return child;\n      }\n    }\n  }\n};\nexport default MenuMixin;","map":{"version":3,"sources":["/Users/administrator/Desktop/DrChain/drchain_frontend/drchain/node_modules/rc-menu/es/MenuMixin.js"],"names":["_extends","React","PropTypes","KeyCode","createChainedFunction","classNames","getKeyFromChildrenIndex","loopMenuItem","DOMWrap","allDisabled","arr","length","every","c","props","disabled","updateActiveKey","store","menuId","activeKey","_extends2","state","getState","setState","getActiveKey","originalActiveKey","children","eventKey","found","i","defaultActiveFirst","saveRef","index","subIndex","undefined","instanceArray","MenuMixin","propTypes","focusable","bool","multiple","style","object","visible","string","selectedKeys","arrayOf","defaultSelectedKeys","defaultOpenKeys","openKeys","any","getDefaultProps","prefixCls","className","mode","level","inlineIndent","componentWillReceiveProps","nextProps","getStore","getEventKey","shouldComponentUpdate","componentWillMount","onKeyDown","e","callback","keyCode","handled","getFlatInstanceArray","forEach","obj","active","activeItem","UP","DOWN","step","preventDefault","onItemHover","key","hover","hasInnerArray","some","a","Array","isArray","push","apply","renderCommonMenuItem","child","extraProps","childProps","isActive","newChildProps","renderMenuItem","rootPrefixCls","parentMenu","manualRef","ref","bind","onClick","openTransitionName","getOpenTransitionName","openAnimation","subMenuOpenDelay","subMenuCloseDelay","forceSubMenuRender","onOpenChange","onDeselect","onSelect","triggerSubMenuAction","cloneElement","renderRoot","_this","domProps","role","id","tabIndex","createElement","tag","hiddenClassName","Children","map","direction","len","concat","reverse","activeIndex","ci","slice","start"],"mappings":"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","sourcesContent":["import _extends from 'babel-runtime/helpers/extends';\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport KeyCode from 'rc-util/es/KeyCode';\nimport createChainedFunction from 'rc-util/es/createChainedFunction';\nimport classNames from 'classnames';\nimport { getKeyFromChildrenIndex, loopMenuItem } from './util';\nimport DOMWrap from './DOMWrap';\n\nfunction allDisabled(arr) {\n  if (!arr.length) {\n    return true;\n  }\n  return arr.every(function (c) {\n    return !!c.props.disabled;\n  });\n}\n\nfunction updateActiveKey(store, menuId, activeKey) {\n  var _extends2;\n\n  var state = store.getState();\n  store.setState({\n    activeKey: _extends({}, state.activeKey, (_extends2 = {}, _extends2[menuId] = activeKey, _extends2))\n  });\n}\n\nexport function getActiveKey(props, originalActiveKey) {\n  var activeKey = originalActiveKey;\n  var children = props.children,\n      eventKey = props.eventKey;\n\n  if (activeKey) {\n    var found = void 0;\n    loopMenuItem(children, function (c, i) {\n      if (c && !c.props.disabled && activeKey === getKeyFromChildrenIndex(c, eventKey, i)) {\n        found = true;\n      }\n    });\n    if (found) {\n      return activeKey;\n    }\n  }\n  activeKey = null;\n  if (props.defaultActiveFirst) {\n    loopMenuItem(children, function (c, i) {\n      if (!activeKey && c && !c.props.disabled) {\n        activeKey = getKeyFromChildrenIndex(c, eventKey, i);\n      }\n    });\n    return activeKey;\n  }\n  return activeKey;\n}\n\nfunction saveRef(index, subIndex, c) {\n  if (c) {\n    if (subIndex !== undefined) {\n      this.instanceArray[index] = this.instanceArray[index] || [];\n      this.instanceArray[index][subIndex] = c;\n    } else {\n      this.instanceArray[index] = c;\n    }\n  }\n}\n\nvar MenuMixin = {\n  propTypes: {\n    focusable: PropTypes.bool,\n    multiple: PropTypes.bool,\n    style: PropTypes.object,\n    defaultActiveFirst: PropTypes.bool,\n    visible: PropTypes.bool,\n    activeKey: PropTypes.string,\n    selectedKeys: PropTypes.arrayOf(PropTypes.string),\n    defaultSelectedKeys: PropTypes.arrayOf(PropTypes.string),\n    defaultOpenKeys: PropTypes.arrayOf(PropTypes.string),\n    openKeys: PropTypes.arrayOf(PropTypes.string),\n    children: PropTypes.any\n  },\n\n  getDefaultProps: function getDefaultProps() {\n    return {\n      prefixCls: 'rc-menu',\n      className: '',\n      mode: 'vertical',\n      level: 1,\n      inlineIndent: 24,\n      visible: true,\n      focusable: true,\n      style: {}\n    };\n  },\n  componentWillReceiveProps: function componentWillReceiveProps(nextProps) {\n    var originalActiveKey = 'activeKey' in nextProps ? nextProps.activeKey : this.getStore().getState().activeKey[this.getEventKey()];\n    var activeKey = getActiveKey(nextProps, originalActiveKey);\n    if (activeKey !== originalActiveKey) {\n      updateActiveKey(this.getStore(), this.getEventKey(), activeKey);\n    }\n  },\n  shouldComponentUpdate: function shouldComponentUpdate(nextProps) {\n    return this.props.visible || nextProps.visible;\n  },\n  componentWillMount: function componentWillMount() {\n    this.instanceArray = [];\n  },\n\n\n  // all keyboard events callbacks run from here at first\n  onKeyDown: function onKeyDown(e, callback) {\n    var keyCode = e.keyCode;\n    var handled = void 0;\n    this.getFlatInstanceArray().forEach(function (obj) {\n      if (obj && obj.props.active && obj.onKeyDown) {\n        handled = obj.onKeyDown(e);\n      }\n    });\n    if (handled) {\n      return 1;\n    }\n    var activeItem = null;\n    if (keyCode === KeyCode.UP || keyCode === KeyCode.DOWN) {\n      activeItem = this.step(keyCode === KeyCode.UP ? -1 : 1);\n    }\n    if (activeItem) {\n      e.preventDefault();\n      updateActiveKey(this.getStore(), this.getEventKey(), activeItem.props.eventKey);\n\n      if (typeof callback === 'function') {\n        callback(activeItem);\n      }\n\n      return 1;\n    } else if (activeItem === undefined) {\n      e.preventDefault();\n      updateActiveKey(this.getStore(), this.getEventKey(), null);\n      return 1;\n    }\n  },\n  onItemHover: function onItemHover(e) {\n    var key = e.key,\n        hover = e.hover;\n\n    updateActiveKey(this.getStore(), this.getEventKey(), hover ? key : null);\n  },\n  getEventKey: function getEventKey() {\n    // when eventKey not available ,it's menu and return menu id '0-menu-'\n    return this.props.eventKey || '0-menu-';\n  },\n  getStore: function getStore() {\n    var store = this.store || this.props.store;\n\n    return store;\n  },\n  getFlatInstanceArray: function getFlatInstanceArray() {\n    var instanceArray = this.instanceArray;\n    var hasInnerArray = instanceArray.some(function (a) {\n      return Array.isArray(a);\n    });\n    if (hasInnerArray) {\n      instanceArray = [];\n      this.instanceArray.forEach(function (a) {\n        if (Array.isArray(a)) {\n          instanceArray.push.apply(instanceArray, a);\n        } else {\n          instanceArray.push(a);\n        }\n      });\n      this.instanceArray = instanceArray;\n    }\n    return instanceArray;\n  },\n  renderCommonMenuItem: function renderCommonMenuItem(child, i, subIndex, extraProps) {\n    var state = this.getStore().getState();\n    var props = this.props;\n    var key = getKeyFromChildrenIndex(child, props.eventKey, i);\n    var childProps = child.props;\n    var isActive = key === state.activeKey;\n    var newChildProps = _extends({\n      mode: props.mode,\n      level: props.level,\n      inlineIndent: props.inlineIndent,\n      renderMenuItem: this.renderMenuItem,\n      rootPrefixCls: props.prefixCls,\n      index: i,\n      parentMenu: this,\n      // customized ref function, need to be invoked manually in child's componentDidMount\n      manualRef: childProps.disabled ? undefined : createChainedFunction(child.ref, saveRef.bind(this, i, subIndex)),\n      eventKey: key,\n      active: !childProps.disabled && isActive,\n      multiple: props.multiple,\n      onClick: this.onClick,\n      onItemHover: this.onItemHover,\n      openTransitionName: this.getOpenTransitionName(),\n      openAnimation: props.openAnimation,\n      subMenuOpenDelay: props.subMenuOpenDelay,\n      subMenuCloseDelay: props.subMenuCloseDelay,\n      forceSubMenuRender: props.forceSubMenuRender,\n      onOpenChange: this.onOpenChange,\n      onDeselect: this.onDeselect,\n      onSelect: this.onSelect\n    }, extraProps);\n    if (props.mode === 'inline') {\n      newChildProps.triggerSubMenuAction = 'click';\n    }\n    return React.cloneElement(child, newChildProps);\n  },\n  renderRoot: function renderRoot(props) {\n    var _this = this;\n\n    this.instanceArray = [];\n    var className = classNames(props.prefixCls, props.className, props.prefixCls + '-' + props.mode);\n    var domProps = {\n      className: className,\n      role: 'menu',\n      'aria-activedescendant': ''\n    };\n    if (props.id) {\n      domProps.id = props.id;\n    }\n    if (props.focusable) {\n      domProps.tabIndex = '0';\n      domProps.onKeyDown = this.onKeyDown;\n    }\n    return (\n      // ESLint is not smart enough to know that the type of `children` was checked.\n      /* eslint-disable */\n      React.createElement(\n        DOMWrap,\n        _extends({\n          style: props.style,\n          tag: 'ul',\n          hiddenClassName: props.prefixCls + '-hidden',\n          visible: props.visible\n        }, domProps),\n        React.Children.map(props.children, function (c, i, subIndex) {\n          return _this.renderMenuItem(c, i, subIndex, props.eventKey || '0-menu-');\n        })\n      )\n      /*eslint-enable */\n\n    );\n  },\n  step: function step(direction) {\n    var children = this.getFlatInstanceArray();\n    var activeKey = this.getStore().getState().activeKey[this.getEventKey()];\n    var len = children.length;\n    if (!len) {\n      return null;\n    }\n    if (direction < 0) {\n      children = children.concat().reverse();\n    }\n    // find current activeIndex\n    var activeIndex = -1;\n    children.every(function (c, ci) {\n      if (c && c.props.eventKey === activeKey) {\n        activeIndex = ci;\n        return false;\n      }\n      return true;\n    });\n    if (!this.props.defaultActiveFirst && activeIndex !== -1) {\n      if (allDisabled(children.slice(activeIndex, len - 1))) {\n        return undefined;\n      }\n    }\n    var start = (activeIndex + 1) % len;\n    var i = start;\n    for (;;) {\n      var child = children[i];\n      if (!child || child.props.disabled) {\n        i = (i + 1 + len) % len;\n        // complete a loop\n        if (i === start) {\n          return null;\n        }\n      } else {\n        return child;\n      }\n    }\n  }\n};\n\nexport default MenuMixin;"]},"metadata":{},"sourceType":"module"}